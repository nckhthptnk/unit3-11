<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit 3: Global Warming and Ecological Systems</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
    }
    
    html {
      height: 100%;
    }
    
    .flashcard {
      perspective: 1000px;
      cursor: pointer;
      height: 320px;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }
    
    @media (min-width: 640px) {
      .flashcard {
        height: 400px;
      }
    }
    
    @media (min-width: 768px) {
      .flashcard {
        height: 450px;
      }
    }
    
    .flashcard-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    
    .flashcard.flipped .flashcard-inner {
      transform: rotateY(180deg);
    }
    
    .flashcard-front, .flashcard-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      text-align: center;
    }
    
    @media (min-width: 640px) {
      .flashcard-front, .flashcard-back {
        padding: 30px;
        border-radius: 14px;
      }
    }
    
    @media (min-width: 768px) {
      .flashcard-front, .flashcard-back {
        padding: 40px;
        border-radius: 16px;
      }
    }
    
    .flashcard-back {
      transform: rotateY(180deg);
    }
    
    .flashcard-front h2 {
      font-size: 1.75rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .flashcard-front h4 {
      font-size: 1rem;
      margin-bottom: 0.5rem;
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .flashcard-front p {
      color: white;
      font-size: 0.9rem;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .flashcard-back h3 {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 0.25rem;
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .flashcard-back h4 {
      font-size: 1rem;
      margin-bottom: 0.75rem;
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .flashcard-back p {
      color: white;
      font-size: 0.9rem;
      line-height: 1.5;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    @media (min-width: 640px) {
      .flashcard-front h2 {
        font-size: 2.25rem;
        margin-bottom: 0.75rem;
      }
      
      .flashcard-front h4 {
        font-size: 1.15rem;
      }
      
      .flashcard-front p {
        font-size: 1rem;
      }
      
      .flashcard-back h3 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }
      
      .flashcard-back h4 {
        font-size: 1.15rem;
        margin-bottom: 1rem;
      }
      
      .flashcard-back p {
        font-size: 1rem;
      }
    }
    
    @media (min-width: 768px) {
      .flashcard-front h2 {
        font-size: 3rem;
        margin-bottom: 1rem;
      }
      
      .flashcard-front h4 {
        font-size: 1.25rem;
      }
      
      .flashcard-front p {
        font-size: 1.1rem;
      }
      
      .flashcard-back h3 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
      }
      
      .flashcard-back h4 {
        font-size: 1.3rem;
        margin-bottom: 1.5rem;
      }
      
      .flashcard-back p {
        font-size: 1.1rem;
        line-height: 1.6;
      }
    }
    
    .highlight {
      background-color: #fef08a;
      padding: 2px 6px;
      border-radius: 3px;
      font-weight: 600;
      color: #854d0e;
    }
    
    .quiz-option {
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .quiz-option:hover:not(.correct):not(.incorrect) {
      transform: translateX(4px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }
    
    .quiz-option.correct {
      background-color: #86efac !important;
      border-color: #22c55e !important;
      color: #166534 !important;
    }
    
    .quiz-option.incorrect {
      background-color: #fca5a5 !important;
      border-color: #ef4444 !important;
      color: #991b1b !important;
    }
    
    .progress-bar {
      transition: width 0.5s ease;
      background-color: #0ea5e9;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.4s ease;
    }
    
    .grammar-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
    }
    
    .grammar-content.active {
      max-height: 3000px;
    }
    
    .tab-button {
      transition: all 0.3s;
    }
    
    .tab-button.active {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    
    .control-button {
      transition: all 0.2s;
    }
    
    .control-button:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
    
    .control-button:active {
      transform: scale(0.98);
    }
    
    .progress-card {
      transition: all 0.3s;
    }
    
    .progress-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }
    

  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body>
  <div id="app" class="min-h-full"><!-- Header -->
   <header class="py-4 px-3 sm:py-6 sm:px-4 md:py-8 md:px-6">
    <div class="max-w-6xl mx-auto">
     <div class="mb-3 sm:mb-4"><a href="https://nckhthptnk.github.io/tienganh11/" target="_blank" rel="noopener noreferrer" id="home-btn" class="control-button inline-block px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base mb-3 sm:mb-4"> <span id="home-button-text">ğŸ  Trang chá»§</span> </a>
      <h1 id="unit-title" class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold leading-tight">Unit 3: Global Warming and Ecological Systems</h1>
     </div><!-- Progress Section -->
     <div class="mt-4 sm:mt-6">
      <h2 id="progress-title" class="text-lg sm:text-xl md:text-2xl font-bold mb-3 sm:mb-4">ğŸ“Š Tiáº¿n Ä‘á»™ há»c táº­p</h2>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4">
       <div class="progress-card rounded-lg p-3 sm:p-4 shadow-md">
        <div class="text-xs sm:text-sm md:text-base font-medium mb-1 sm:mb-2">
         Tá»•ng
        </div>
        <div class="text-xl sm:text-2xl md:text-3xl font-bold" id="total-progress">
         0%
        </div>
       </div>
       <div class="progress-card rounded-lg p-3 sm:p-4 shadow-md">
        <div class="text-xs sm:text-sm md:text-base font-medium mb-1 sm:mb-2">
         Tá»« vá»±ng
        </div>
        <div class="text-xl sm:text-2xl md:text-3xl font-bold" id="vocab-progress">
         0%
        </div>
       </div>
       <div class="progress-card rounded-lg p-3 sm:p-4 shadow-md">
        <div class="text-xs sm:text-sm md:text-base font-medium mb-1 sm:mb-2">
         BÃ i Ä‘á»c
        </div>
        <div class="text-xl sm:text-2xl md:text-3xl font-bold" id="reading-progress">
         0%
        </div>
       </div>
       <div class="progress-card rounded-lg p-3 sm:p-4 shadow-md">
        <div class="text-xs sm:text-sm md:text-base font-medium mb-1 sm:mb-2">
         Ngá»¯ phÃ¡p
        </div>
        <div class="text-xl sm:text-2xl md:text-3xl font-bold" id="grammar-progress">
         0%
        </div>
       </div>
      </div>
     </div>
    </div>
   </header><!-- Tab Navigation -->
   <div class="flex justify-center gap-1 sm:gap-2 md:gap-4 px-2 sm:px-4 md:px-6 mb-4 sm:mb-6 md:mb-8 flex-wrap"><button id="vocab-tab" class="tab-button px-2 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-xs sm:text-sm md:text-base active"> <span id="vocabulary-tab-text">ğŸ“š Tá»« vá»±ng</span> </button> <button id="reading-tab" class="tab-button px-2 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-xs sm:text-sm md:text-base"> <span id="reading-tab-text">ğŸ“– BÃ i Ä‘á»c</span> </button> <button id="grammar-tab" class="tab-button px-2 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-xs sm:text-sm md:text-base"> <span id="grammar-tab-text">âœï¸ Ngá»¯ phÃ¡p</span> </button> <button id="ecosystem-tab" class="tab-button px-2 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-xs sm:text-sm md:text-base"> <span id="ecosystem-tab-text">ğŸŒ Ecosystem</span> </button>
   </div><!-- Main Content -->
   <main class="px-4 md:px-6 pb-8"><!-- Vocabulary Section -->
    <div id="vocab-section" class="max-w-6xl mx-auto"><!-- Mode Toggle Buttons -->
     <div class="flex justify-center gap-2 sm:gap-3 mb-4 sm:mb-6"><button id="flashcard-mode-btn" class="control-button px-4 py-2 sm:px-6 sm:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base"> ğŸ“š Há»c tá»« </button> <button id="test-mode-btn" class="control-button px-4 py-2 sm:px-6 sm:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base" style="opacity: 0.7;"> âœï¸ Kiá»ƒm tra </button>
     </div><!-- Flashcard Mode -->
     <div id="flashcard-mode">
      <div class="mb-4 sm:mb-6">
       <div class="flex justify-between items-center mb-2"><span class="text-xs sm:text-sm md:text-base font-medium">Tiáº¿n Ä‘á»™ tá»« vá»±ng</span> <span id="card-counter" class="text-xs sm:text-sm md:text-base font-medium">1 / 61</span>
       </div>
       <div class="w-full h-2 sm:h-3 rounded-full overflow-hidden" style="background-color: #e0f2fe;">
        <div id="vocab-progress-bar" class="progress-bar h-full" style="width: 6.67%; background-color: #0ea5e9;"></div>
       </div>
      </div>
      <div id="flashcard-container" class="flashcard mb-6">
       <div class="flashcard-inner">
        <div class="flashcard-front">
         <h2>reuse (v)</h2>
         <h4 class="text-xl mt-2" style="color: rgba(255, 255, 255, 0.9);">/ËŒriËËˆjuËz/</h4>
         <p class="text-base mt-3 px-4 py-2 rounded-lg" style="background-color: rgba(255, 255, 255, 0.2);">Verb</p>
         <p class="text-lg mt-4">Nháº¥n Ä‘á»ƒ xem Ä‘á»‹nh nghÄ©a</p>
        </div>
        <div class="flashcard-back">
         <h3>reuse (v)</h3>
         <h4>/ËŒriËËˆjuËz/</h4>
         <p class="mb-3"><strong>Verb:</strong> TÃ¡i sá»­ dá»¥ng</p>
         <p><em>Example:</em> We should reuse plastic bottles instead of throwing them away.</p>
        </div>
       </div>
      </div>
      <div class="flex justify-between max-w-md mx-auto gap-2 sm:gap-4"><button id="prev-btn" class="control-button px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base flex-1"> â† LÃ¹i </button> <button id="next-btn" class="control-button px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base flex-1"> Tiáº¿p â†’ </button>
      </div>
     </div><!-- Test Mode -->
     <div id="test-mode" class="hidden">
      <div class="mb-4 sm:mb-6">
       <div class="flex justify-between items-center mb-2"><span class="text-xs sm:text-sm md:text-base font-medium">Kiá»ƒm tra tá»« vá»±ng</span> <span id="test-counter" class="text-xs sm:text-sm md:text-base font-medium">CÃ¢u 1 / 62</span>
       </div>
       <div class="w-full h-2 sm:h-3 rounded-full overflow-hidden" style="background-color: #e0f2fe;">
        <div id="test-progress-bar" class="progress-bar h-full" style="width: 1.61%; background-color: #0ea5e9;"></div>
       </div>
      </div>
      <div id="vocab-test-container" class="max-w-4xl mx-auto"><!-- Current test question will be displayed here -->
      </div><!-- Navigation buttons -->
      <div class="flex justify-between gap-2 sm:gap-4 mb-4 sm:mb-6 max-w-4xl mx-auto"><button id="prev-vocab-test-btn" class="control-button px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base flex-1" disabled style="opacity: 0.5;"> â† CÃ¢u trÆ°á»›c </button> <button id="next-vocab-test-btn" class="control-button px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base flex-1"> CÃ¢u tiáº¿p â†’ </button>
      </div>
      <div id="test-result" class="mt-6 p-6 rounded-lg hidden max-w-4xl mx-auto">
       <p class="text-2xl font-bold text-center mb-2"></p>
       <p class="text-center text-lg"></p>
      </div>
     </div>
    </div><!-- Reading Section -->
    <div id="reading-section" class="max-w-4xl mx-auto hidden">
     <div class="rounded-lg p-4 sm:p-6 md:p-8 shadow-lg mb-4 sm:mb-6">
      <h2 class="text-xl sm:text-2xl md:text-3xl font-bold mb-4 sm:mb-6 leading-tight">The Impact of Global Warming on Our Planet</h2>
      <div id="reading-text" class="text-sm sm:text-base md:text-lg leading-relaxed space-y-3 sm:space-y-4 mb-6 sm:mb-8">
       <p><span class="highlight">Global warming</span> is one of the most <u>pressing</u> environmental issues facing humanity today. The Earth's average temperature has risen significantly over the past century, primarily due to increased <span class="highlight">greenhouse gas emissions</span> from human activities. <u>These</u> emissions, particularly carbon dioxide and methane, trap heat in the atmosphere, creating what scientists call the <span class="highlight">greenhouse effect</span>.</p>
       <p>The consequences of <span class="highlight">climate change</span> are already visible worldwide. Polar ice caps are melting at an <u>alarming</u> rate, causing sea levels to rise and threatening coastal communities. Extreme weather events, such as hurricanes, droughts, and floods, have become more frequent and severe. Many <span class="highlight">ecosystems</span> are struggling to adapt to these rapid changes, leading to the extinction of numerous plant and animal species.</p>
       <p><span class="highlight">Deforestation</span> compounds the problem by removing trees that naturally absorb carbon dioxide from the atmosphere. <strong>[I]</strong> The Amazon rainforest, often called the <u>"lungs of the Earth,"</u> has lost vast areas to logging and agriculture. <strong>[II]</strong> Additionally, the burning of <span class="highlight">fossil fuels</span> for energy production continues to be the largest contributor to atmospheric <span class="highlight">pollution</span>. <strong>[III]</strong> Scientists warn that if current trends continue, we may reach irreversible tipping points in the climate system. <strong>[IV]</strong></p>
       <p>However, there is hope. Many countries are now investing in <span class="highlight">renewable energy</span> sources such as solar and wind power. Individuals can contribute by reducing their carbon footprint through simple actions like using public transportation, recycling, and consuming less meat. Scientists emphasize that <u>if we act now, we can still mitigate the worst effects of global warming and preserve our planet for future generations.</u> The key is immediate and collective action from governments, businesses, and individuals worldwide.</p>
      </div>
     </div>
     <div class="rounded-lg p-4 sm:p-6 md:p-8 shadow-lg">
      <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-4 sm:mb-6">CÃ¢u há»i tráº¯c nghiá»‡m</h3>
      <div id="reading-quiz" class="space-y-4 sm:space-y-6"><!-- Questions will be inserted here -->
      </div><button id="submit-reading" class="control-button w-full mt-4 sm:mt-6 py-2 sm:py-3 rounded-lg font-semibold text-white text-sm sm:text-base md:text-lg"> <span id="submit-button-text">Ná»™p cÃ¢u tráº£ lá»i</span> </button>
      <div id="reading-result" class="mt-4 sm:mt-6 p-3 sm:p-4 rounded-lg hidden">
       <p class="text-base sm:text-lg md:text-xl font-bold text-center"></p>
      </div>
     </div>
    </div><!-- Ecosystem Section -->
    <div id="ecosystem-section" class="max-w-4xl mx-auto hidden">
     <div class="rounded-lg p-4 sm:p-6 md:p-8 shadow-lg mb-4 sm:mb-6">
      <h2 class="text-xl sm:text-2xl md:text-3xl font-bold mb-4 sm:mb-6 leading-tight">Understanding Ecosystems and Global Warming</h2><!-- What is an Ecosystem -->
      <div class="mb-8">
       <h3 class="text-xl md:text-2xl font-bold mb-4 flex items-center"><span class="text-3xl mr-3">ğŸŒ¿</span> What is an Ecosystem?</h3>
       <div class="space-y-4 text-base md:text-lg leading-relaxed">
        <p>An <strong>ecosystem</strong> is a community of living organisms (plants, animals, and microorganisms) interacting with each other and their physical environment (air, water, soil, and climate). Ecosystems can be as small as a pond or as large as a rainforest.</p>
        <p><strong>Key Components:</strong></p>
        <ul class="list-disc list-inside space-y-2 ml-4">
         <li><strong>Biotic factors:</strong> Living things (producers, consumers, decomposers)</li>
         <li><strong>Abiotic factors:</strong> Non-living elements (sunlight, temperature, water, minerals)</li>
         <li><strong>Energy flow:</strong> Transfer of energy through food chains and food webs</li>
         <li><strong>Nutrient cycling:</strong> Movement of nutrients through the ecosystem</li>
        </ul>
       </div>
      </div><!-- Types of Ecosystems -->
      <div class="mb-8">
       <h3 class="text-xl md:text-2xl font-bold mb-4 flex items-center"><span class="text-3xl mr-3">ğŸŒ</span> Major Types of Ecosystems</h3>
       <div class="grid md:grid-cols-2 gap-4">
        <div class="p-4 rounded-lg border-2">
         <h4 class="font-bold text-lg mb-2 flex items-center justify-between"><span>ğŸŒ³ Forest Ecosystems</span> <button onclick="speakWord('Forest Ecosystems')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Tropical rainforests, temperate forests, and boreal forests. Home to 80% of terrestrial biodiversity.</p>
        </div>
        <div class="p-4 rounded-lg border-2">
         <h4 class="font-bold text-lg mb-2 flex items-center justify-between"><span>ğŸŒŠ Marine Ecosystems</span> <button onclick="speakWord('Marine Ecosystems')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Oceans, coral reefs, and estuaries. Cover 71% of Earth's surface and produce 50% of oxygen.</p>
        </div>
        <div class="p-4 rounded-lg border-2">
         <h4 class="font-bold text-lg mb-2 flex items-center justify-between"><span>ğŸœï¸ Desert Ecosystems</span> <button onclick="speakWord('Desert Ecosystems')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Hot and cold deserts with specialized plants and animals adapted to extreme conditions.</p>
        </div>
        <div class="p-4 rounded-lg border-2">
         <h4 class="font-bold text-lg mb-2 flex items-center justify-between"><span>ğŸŒ¾ Grassland Ecosystems</span> <button onclick="speakWord('Grassland Ecosystems')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Savannas, prairies, and steppes. Important for agriculture and grazing animals.</p>
        </div>
        <div class="p-4 rounded-lg border-2">
         <h4 class="font-bold text-lg mb-2 flex items-center justify-between"><span>ğŸ’§ Freshwater Ecosystems</span> <button onclick="speakWord('Freshwater Ecosystems')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Rivers, lakes, wetlands, and swamps. Provide drinking water and support diverse life.</p>
        </div>
        <div class="p-4 rounded-lg border-2">
         <h4 class="font-bold text-lg mb-2 flex items-center justify-between"><span>â„ï¸ Tundra Ecosystems</span> <button onclick="speakWord('Tundra Ecosystems')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Arctic and alpine regions with permafrost, short growing seasons, and hardy species.</p>
        </div>
       </div>
      </div><!-- Impact of Global Warming -->
      <div class="mb-8">
       <h3 class="text-xl md:text-2xl font-bold mb-4 flex items-center"><span class="text-3xl mr-3">ğŸ”¥</span> How Global Warming Affects Ecosystems</h3>
       <div class="space-y-4">
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸŒ¡ï¸ Rising Temperatures</span> <button onclick="speakWord('Rising Temperatures')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Higher temperatures disrupt breeding cycles, migration patterns, and food availability. Many species cannot adapt quickly enough.</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸ§Š Melting Ice Caps</span> <button onclick="speakWord('Melting Ice Caps')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Arctic ecosystems are losing habitat. Polar bears, seals, and penguins face extinction as sea ice disappears.</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸŒŠ Ocean Acidification</span> <button onclick="speakWord('Ocean Acidification')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Increased COâ‚‚ makes oceans more acidic, harming coral reefs, shellfish, and marine food chains.</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸ”¥ Increased Wildfires</span> <button onclick="speakWord('Increased Wildfires')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Hotter, drier conditions lead to more frequent and intense wildfires, destroying forests and wildlife habitats.</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸ’§ Changing Precipitation</span> <button onclick="speakWord('Changing Precipitation')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Some areas experience droughts while others face flooding, disrupting water-dependent ecosystems.</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸ¦‹ Species Extinction</span> <button onclick="speakWord('Species Extinction')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Climate change is 1000x faster than natural evolution. Many species cannot adapt and face extinction.</p>
        </div>
       </div>
      </div><!-- Ecosystem Services -->
      <div class="mb-8">
       <h3 class="text-xl md:text-2xl font-bold mb-4 flex items-center"><span class="text-3xl mr-3">ğŸ’š</span> Why Ecosystems Matter</h3>
       <div class="space-y-3 text-base md:text-lg">
        <p><strong>Ecosystem services</strong> are the benefits humans receive from nature:</p>
        <ul class="list-disc list-inside space-y-2 ml-4">
         <li><strong>Provisioning:</strong> Food, water, timber, fiber, and medicines</li>
         <li><strong>Regulating:</strong> Climate regulation, flood control, water purification, pollination</li>
         <li><strong>Supporting:</strong> Nutrient cycling, soil formation, oxygen production</li>
         <li><strong>Cultural:</strong> Recreation, spiritual values, education, tourism</li>
        </ul>
        <p class="mt-4 p-4 rounded-lg font-semibold">âš ï¸ When ecosystems collapse, these services disappear, threatening human survival and well-being.</p>
       </div>
      </div><!-- What Can We Do -->
      <div class="mb-8">
       <h3 class="text-xl md:text-2xl font-bold mb-4 flex items-center"><span class="text-3xl mr-3">ğŸŒ±</span> Protecting Ecosystems</h3>
       <div class="grid md:grid-cols-2 gap-4">
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸŒ³ Reforestation</span> <button onclick="speakWord('Reforestation')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Plant trees to absorb COâ‚‚ and restore habitats</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>â™»ï¸ Reduce, Reuse, Recycle</span> <button onclick="speakWord('Reduce, Reuse, Recycle')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Minimize waste and conserve resources</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>âš¡ Use Renewable Energy</span> <button onclick="speakWord('Use Renewable Energy')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Switch to solar, wind, and hydroelectric power</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸš— Reduce Carbon Footprint</span> <button onclick="speakWord('Reduce Carbon Footprint')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Use public transport, bike, or walk more</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸ›¡ï¸ Support Conservation</span> <button onclick="speakWord('Support Conservation')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Protect endangered species and habitats</p>
        </div>
        <div class="p-4 rounded-lg">
         <h4 class="font-bold mb-2 flex items-center justify-between"><span>ğŸ“¢ Raise Awareness</span> <button onclick="speakWord('Raise Awareness')" class="ml-2 px-3 py-1 rounded-full text-sm hover:opacity-80 transition-opacity" style="background-color: #0ea5e9; color: white;">ğŸ”Š</button></h4>
         <p class="text-sm md:text-base">Educate others about climate change</p>
        </div>
       </div>
      </div><!-- Key Facts -->
      <div class="p-6 rounded-lg border-4">
       <h3 class="text-xl md:text-2xl font-bold mb-4 text-center">ğŸ“Š Key Facts About Ecosystems &amp; Climate</h3>
       <div class="grid md:grid-cols-2 gap-4 text-sm md:text-base">
        <div class="p-3 rounded">
         <p><strong>ğŸŒ 1 million species</strong> are at risk of extinction due to climate change</p>
        </div>
        <div class="p-3 rounded">
         <p><strong>ğŸŒ¡ï¸ 1.1Â°C increase</strong> in global temperature since pre-industrial times</p>
        </div>
        <div class="p-3 rounded">
         <p><strong>ğŸŒ³ 10 million hectares</strong> of forest are lost each year</p>
        </div>
        <div class="p-3 rounded">
         <p><strong>ğŸ  50% of coral reefs</strong> have died in the last 30 years</p>
        </div>
        <div class="p-3 rounded">
         <p><strong>â„ï¸ Arctic ice</strong> is melting at 13% per decade</p>
        </div>
        <div class="p-3 rounded">
         <p><strong>ğŸŒŠ Sea levels</strong> have risen 20cm since 1900</p>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Grammar Section -->
    <div id="grammar-section" class="max-w-4xl mx-auto hidden">
     <div class="space-y-3 sm:space-y-4 mb-6 sm:mb-8">
      <div class="rounded-lg p-3 sm:p-4 md:p-6 shadow-lg"><button class="grammar-toggle w-full text-left flex justify-between items-center" data-target="present-perfect"> <h3 class="text-base sm:text-lg md:text-xl font-bold">Present Perfect</h3><span class="text-xl sm:text-2xl font-bold">+</span> </button>
       <div id="present-perfect" class="grammar-content mt-4">
        <div class="space-y-4">
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Cáº¥u trÃºc:</p>
          <p class="mb-2"><span class="highlight">have/has + past participle</span></p>
          <p class="text-sm">Example: Scientists <span class="highlight">have discovered</span> new evidence of climate change.</p>
         </div>
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">CÃ¡ch dÃ¹ng:</p>
          <ul class="list-disc list-inside space-y-1 text-sm md:text-base">
           <li>HÃ nh Ä‘á»™ng xáº£y ra trong quÃ¡ khá»©, khÃ´ng rÃµ thá»i gian</li>
           <li>HÃ nh Ä‘á»™ng báº¯t Ä‘áº§u trong quÃ¡ khá»© vÃ  tiáº¿p tá»¥c Ä‘áº¿n hiá»‡n táº¡i</li>
           <li>Kinh nghiá»‡m sá»‘ng</li>
          </ul>
         </div>
        </div>
       </div>
      </div>
      <div class="rounded-lg p-4 md:p-6 shadow-lg"><button class="grammar-toggle w-full text-left flex justify-between items-center" data-target="past-perfect"> <h3 class="text-lg md:text-xl font-bold">Past Perfect</h3><span class="text-2xl font-bold">+</span> </button>
       <div id="past-perfect" class="grammar-content mt-4">
        <div class="space-y-4">
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Cáº¥u trÃºc:</p>
          <p class="mb-2"><span class="highlight">had + past participle</span></p>
          <p class="text-sm">Example: The ice <span class="highlight">had melted</span> before scientists arrived.</p>
         </div>
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">CÃ¡ch dÃ¹ng:</p>
          <ul class="list-disc list-inside space-y-1 text-sm md:text-base">
           <li>HÃ nh Ä‘á»™ng xáº£y ra trÆ°á»›c má»™t hÃ nh Ä‘á»™ng khÃ¡c trong quÃ¡ khá»©</li>
           <li>DÃ¹ng vá»›i by the time, before, after, when</li>
          </ul>
         </div>
        </div>
       </div>
      </div>
      <div class="rounded-lg p-4 md:p-6 shadow-lg"><button class="grammar-toggle w-full text-left flex justify-between items-center" data-target="conditionals"> <h3 class="text-lg md:text-xl font-bold">Conditionals (CÃ¢u Ä‘iá»u kiá»‡n)</h3><span class="text-2xl font-bold">+</span> </button>
       <div id="conditionals" class="grammar-content mt-4">
        <div class="space-y-4">
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Type 1 - CÃ³ thá»ƒ xáº£y ra:</p>
          <p class="mb-2"><span class="highlight">If + present simple, will + verb</span></p>
          <p class="text-sm">If we reduce emissions, the planet will recover.</p>
         </div>
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Type 2 - KhÃ´ng cÃ³ tháº­t á»Ÿ hiá»‡n táº¡i:</p>
          <p class="mb-2"><span class="highlight">If + past simple, would + verb</span></p>
          <p class="text-sm">If we had more forests, air quality would improve.</p>
         </div>
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Type 3 - KhÃ´ng cÃ³ tháº­t trong quÃ¡ khá»©:</p>
          <p class="mb-2"><span class="highlight">If + past perfect, would have + past participle</span></p>
          <p class="text-sm">If we had acted earlier, we would have prevented this.</p>
         </div>
        </div>
       </div>
      </div>
      <div class="rounded-lg p-4 md:p-6 shadow-lg"><button class="grammar-toggle w-full text-left flex justify-between items-center" data-target="inversion"> <h3 class="text-lg md:text-xl font-bold">Äáº£o ngá»¯ (Inversion)</h3><span class="text-2xl font-bold">+</span> </button>
       <div id="inversion" class="grammar-content mt-4">
        <div class="space-y-4">
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Äáº£o ngá»¯ vá»›i IF:</p>
          <p class="mb-2"><span class="highlight">Had/Were/Should + S + V, S + would/will + V</span></p>
          <p class="text-sm">Had we known, we would have acted differently.</p>
          <p class="text-sm">Were I the president, I would ban fossil fuels.</p>
         </div>
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">No sooner... than:</p>
          <p class="mb-2"><span class="highlight">No sooner + had + S + past participle + than + S + past simple</span></p>
          <p class="text-sm">No sooner had the rain stopped than the sun appeared.</p>
         </div>
         <div class="p-4 rounded-lg">
          <p class="font-semibold mb-2">Hardly/Scarcely... when:</p>
          <p class="mb-2"><span class="highlight">Hardly/Scarcely + had + S + past participle + when + S + past simple</span></p>
          <p class="text-sm">Hardly had we arrived when the storm began.</p>
         </div>
        </div>
       </div>
      </div>
      <div class="p-4 md:p-6 rounded-lg mb-4" style="background-color: #fef3c7; border-left: 4px solid #f59e0b;">
       <p class="text-base md:text-lg font-semibold" style="color: #92400e;">ğŸ’¡ Báº¡n cáº§n hoÃ n thÃ nh bÃ i táº­p tá»•ng há»£p Ä‘á»ƒ hoÃ n thÃ nh tiáº¿n Ä‘á»™ há»c nhÃ©!</p>
      </div>
      <div class="rounded-lg p-4 md:p-6 shadow-lg"><button class="grammar-toggle w-full text-left flex justify-between items-center" data-target="comprehensive"> <h3 class="text-lg md:text-xl font-bold">BÃ i táº­p tá»•ng há»£p (30 cÃ¢u)</h3><span class="text-2xl font-bold">+</span> </button>
       <div id="comprehensive" class="grammar-content mt-4"><!-- Progress bar -->
        <div class="mb-4 sm:mb-6">
         <div class="flex justify-between items-center mb-2"><span class="text-xs sm:text-sm md:text-base font-medium">Tiáº¿n Ä‘á»™ bÃ i táº­p</span> <span id="grammar-counter" class="text-xs sm:text-sm md:text-base font-medium">CÃ¢u 1 / 30</span>
         </div>
         <div class="w-full h-2 sm:h-3 rounded-full overflow-hidden" style="background-color: #e0f2fe;">
          <div id="grammar-progress-bar" class="progress-bar h-full" style="width: 3.33%; background-color: #0ea5e9;"></div>
         </div>
        </div><!-- Single question display -->
        <div id="grammar-quiz-container" class="mb-4 sm:mb-6"><!-- Current question will be displayed here -->
        </div><!-- Navigation buttons -->
        <div class="flex justify-between gap-2 sm:gap-4 mb-4 sm:mb-6"><button id="prev-grammar-btn" class="control-button px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base flex-1" disabled style="opacity: 0.5;"> â† CÃ¢u trÆ°á»›c </button> <button id="next-grammar-btn" class="control-button px-3 py-2 sm:px-4 sm:py-2 md:px-6 md:py-3 rounded-lg font-semibold text-white text-xs sm:text-sm md:text-base flex-1"> CÃ¢u tiáº¿p â†’ </button>
        </div><!-- Final result -->
        <div id="grammar-result" class="mt-4 sm:mt-6 p-3 sm:p-4 rounded-lg hidden">
         <p class="text-base sm:text-lg md:text-xl font-bold text-center mb-2"></p>
         <p class="text-center text-sm sm:text-base"></p>
        </div>
       </div>
      </div>
     </div>
    </div>
   </main>
  </div>
  <script>
    const defaultConfig = {
      background_color: "#f0f9ff",
      surface_color: "#ffffff",
      text_color: "#0f172a",
      primary_action_color: "#0ea5e9",
      secondary_action_color: "#e0f2fe",
      unit_title: "Unit 3: Global Warming and Ecological Systems",
      progress_title: "ğŸ“Š Tiáº¿n Ä‘á»™ há»c táº­p",
      vocabulary_tab: "ğŸ“š Tá»« vá»±ng",
      reading_tab: "ğŸ“– BÃ i Ä‘á»c",
      grammar_tab: "âœï¸ Ngá»¯ phÃ¡p",
      ecosystem_tab: "ğŸŒ Ecosystem Info",
      home_button: "ğŸ  Trang chá»§",
      submit_button: "Ná»™p cÃ¢u tráº£ lá»i",
      font_family: "system-ui",
      font_size: 16
    };

    let config = { ...defaultConfig };

    // Vocabulary data
    const vocabularyCards = [
      { word: "reuse (v)", phonetic: "/ËŒriËËˆjuËz/", type: "Verb", definition: "TÃ¡i sá»­ dá»¥ng", example: "We should reuse plastic bottles instead of throwing them away." },
      { word: "reuse (n)", phonetic: "/ËŒriËËˆjuËs/", type: "Noun", definition: "Sá»± tÃ¡i sá»­ dá»¥ng", example: "The reuse of materials helps reduce waste." },
      { word: "reusable", phonetic: "/ËŒriËËˆjuËzÉ™bÉ™l/", type: "Adjective", definition: "CÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng", example: "Reusable bags are better for the environment than plastic ones." },
      { word: "surgeon", phonetic: "/ËˆsÉœËdÊ’É™n/", type: "Noun", definition: "BÃ¡c sÄ© pháº«u thuáº­t", example: "The surgeon performed a successful operation." },
      { word: "wildfire", phonetic: "/ËˆwaÉªldfaÉªÉ™(r)/", type: "Noun", definition: "ChÃ¡y rá»«ng", example: "Wildfires are becoming more frequent due to climate change." },
      { word: "arctic", phonetic: "/ËˆÉ‘ËktÉªk/", type: "Adjective/Noun", definition: "Báº¯c cá»±c", example: "Arctic ice is melting at an alarming rate." },
      { word: "care", phonetic: "/keÉ™(r)/", type: "Noun/Verb", definition: "Sá»± chÄƒm sÃ³c, quan tÃ¢m", example: "We need to take care of our planet." },
      { word: "careful", phonetic: "/ËˆkeÉ™fÉ™l/", type: "Adjective", definition: "Cáº©n tháº­n", example: "Be careful with how you dispose of waste." },
      { word: "careless", phonetic: "/ËˆkeÉ™lÉ™s/", type: "Adjective", definition: "Báº¥t cáº©n", example: "Careless behavior can harm the environment." },
      { word: "caring", phonetic: "/ËˆkeÉ™rÉªÅ‹/", type: "Adjective", definition: "Chu Ä‘Ã¡o, quan tÃ¢m", example: "She is a caring person who loves nature." },
      { word: "computer programmer", phonetic: "/kÉ™mËˆpjuËtÉ™(r) ËˆprÉ™ÊŠÉ¡rÃ¦mÉ™(r)/", type: "Noun", definition: "Láº­p trÃ¬nh viÃªn mÃ¡y tÃ­nh", example: "A computer programmer can work remotely to reduce emissions." },
      { word: "determined", phonetic: "/dÉªËˆtÉœËmÉªnd/", type: "Adjective", definition: "Quyáº¿t tÃ¢m", example: "She is determined to fight climate change." },
      { word: "determinedly", phonetic: "/dÉªËˆtÉœËmÉªndli/", type: "Adverb", definition: "Má»™t cÃ¡ch quyáº¿t tÃ¢m", example: "They worked determinedly to clean up the beach." },
      { word: "determine", phonetic: "/dÉªËˆtÉœËmÉªn/", type: "Verb", definition: "XÃ¡c Ä‘á»‹nh, quyáº¿t Ä‘á»‹nh", example: "Scientists determine the causes of global warming." },
      { word: "determination", phonetic: "/dÉªËŒtÉœËmÉªËˆneÉªÊƒÉ™n/", type: "Noun", definition: "Sá»± quyáº¿t tÃ¢m", example: "Her determination to save the environment is inspiring." },
      { word: "drought", phonetic: "/draÊŠt/", type: "Noun", definition: "Háº¡n hÃ¡n", example: "The drought has affected many farmers this year." },
      { word: "ecosystem", phonetic: "/ËˆiËkÉ™ÊŠËŒsÉªstÉ™m/", type: "Noun", definition: "Há»‡ sinh thÃ¡i", example: "Coral reefs are delicate ecosystems." },
      { word: "effect", phonetic: "/ÉªËˆfekt/", type: "Noun", definition: "áº¢nh hÆ°á»Ÿng, tÃ¡c Ä‘á»™ng", example: "The effect of pollution on health is serious." },
      { word: "affect", phonetic: "/É™Ëˆfekt/", type: "Verb", definition: "áº¢nh hÆ°á»Ÿng Ä‘áº¿n", example: "Climate change affects all living creatures." },
      { word: "affected", phonetic: "/É™ËˆfektÉªd/", type: "Adjective", definition: "Bá»‹ áº£nh hÆ°á»Ÿng", example: "Many species are affected by habitat loss." },
      { word: "emission", phonetic: "/ÉªËˆmÉªÊƒÉ™n/", type: "Noun", definition: "KhÃ­ tháº£i", example: "Carbon emissions are the main cause of global warming." },
      { word: "emit", phonetic: "/ÉªËˆmÉªt/", type: "Verb", definition: "Tháº£i ra, phÃ¡t ra", example: "Cars emit harmful gases into the atmosphere." },
      { word: "extinct", phonetic: "/ÉªkËˆstÉªÅ‹kt/", type: "Adjective", definition: "Tuyá»‡t chá»§ng", example: "Many animals are becoming extinct due to climate change." },
      { word: "extinction", phonetic: "/ÉªkËˆstÉªÅ‹kÊƒÉ™n/", type: "Noun", definition: "Sá»± tuyá»‡t chá»§ng", example: "We must prevent the extinction of endangered species." },
      { word: "extreme weather", phonetic: "/ÉªkËˆstriËm ËˆweÃ°É™(r)/", type: "Noun", definition: "Thá»i tiáº¿t cá»±c Ä‘oan", example: "Extreme weather events are becoming more common." },
      { word: "flight attendant", phonetic: "/flaÉªt É™ËˆtendÉ™nt/", type: "Noun", definition: "Tiáº¿p viÃªn hÃ ng khÃ´ng", example: "The flight attendant explained the safety procedures." },
      { word: "flood", phonetic: "/flÊŒd/", type: "Noun/Verb", definition: "LÅ© lá»¥t", example: "Heavy rain caused severe floods in the region." },
      { word: "fumes", phonetic: "/fjuËmz/", type: "Noun", definition: "KhÃ³i Ä‘á»™c", example: "Car fumes pollute the air in cities." },
      { word: "heat up", phonetic: "/hiËt ÊŒp/", type: "Phrasal Verb", definition: "NÃ³ng lÃªn", example: "The planet is heating up due to greenhouse gases." },
      { word: "heatwave", phonetic: "/ËˆhiËtweÉªv/", type: "Noun", definition: "Äá»£t nÃ³ng", example: "The heatwave lasted for two weeks." },
      { word: "ice cap", phonetic: "/ËˆaÉªs kÃ¦p/", type: "Noun", definition: "Chá»m bÄƒng", example: "The polar ice caps are melting rapidly." },
      { word: "inventive", phonetic: "/ÉªnËˆventÉªv/", type: "Adjective", definition: "SÃ¡ng táº¡o", example: "We need inventive solutions to environmental problems." },
      { word: "inventively", phonetic: "/ÉªnËˆventÉªvli/", type: "Adverb", definition: "Má»™t cÃ¡ch sÃ¡ng táº¡o", example: "She solved the problem inventively." },
      { word: "inventiveness", phonetic: "/ÉªnËˆventÉªvnÉ™s/", type: "Noun", definition: "TÃ­nh sÃ¡ng táº¡o", example: "His inventiveness helped create eco-friendly products." },
      { word: "invent", phonetic: "/ÉªnËˆvent/", type: "Verb", definition: "PhÃ¡t minh", example: "Scientists invent new technologies to reduce pollution." },
      { word: "invention", phonetic: "/ÉªnËˆvenÊƒÉ™n/", type: "Noun", definition: "PhÃ¡t minh", example: "Solar panels are an important invention for clean energy." },
      { word: "inventor", phonetic: "/ÉªnËˆventÉ™(r)/", type: "Noun", definition: "NhÃ  phÃ¡t minh", example: "The inventor created a device to purify water." },
      { word: "landslide", phonetic: "/ËˆlÃ¦ndslaÉªd/", type: "Noun", definition: "Sáº¡t lá»Ÿ Ä‘áº¥t", example: "Heavy rain triggered a landslide in the mountains." },
      { word: "loss", phonetic: "/lÉ’s/", type: "Noun", definition: "Sá»± máº¥t mÃ¡t", example: "The loss of forests affects biodiversity." },
      { word: "lose", phonetic: "/luËz/", type: "Verb", definition: "Máº¥t, Ä‘Ã¡nh máº¥t", example: "We cannot afford to lose more species." },
      { word: "marine", phonetic: "/mÉ™ËˆriËn/", type: "Adjective", definition: "Thuá»™c vá» biá»ƒn", example: "Marine life is threatened by plastic pollution." },
      { word: "organic", phonetic: "/É”ËËˆÉ¡Ã¦nÉªk/", type: "Adjective", definition: "Há»¯u cÆ¡", example: "Organic farming is better for the environment." },
      { word: "organically", phonetic: "/É”ËËˆÉ¡Ã¦nÉªkli/", type: "Adverb", definition: "Má»™t cÃ¡ch há»¯u cÆ¡", example: "These vegetables are grown organically." },
      { word: "plumber", phonetic: "/ËˆplÊŒmÉ™(r)/", type: "Noun", definition: "Thá»£ sá»­a á»‘ng nÆ°á»›c", example: "The plumber fixed the leaking pipe to save water." },
      { word: "politician", phonetic: "/ËŒpÉ’lÉ™ËˆtÉªÊƒÉ™n/", type: "Noun", definition: "ChÃ­nh trá»‹ gia", example: "Politicians should take action on climate change." },
      { word: "politics", phonetic: "/ËˆpÉ’lÉ™tÉªks/", type: "Noun", definition: "ChÃ­nh trá»‹", example: "Environmental politics is becoming more important." },
      { word: "political", phonetic: "/pÉ™ËˆlÉªtÉªkÉ™l/", type: "Adjective", definition: "Thuá»™c vá» chÃ­nh trá»‹", example: "Climate change is a political issue." },
      { word: "put off", phonetic: "/pÊŠt É’f/", type: "Phrasal Verb", definition: "HoÃ£n láº¡i", example: "Don't put off taking action on climate change." },
      { word: "put on", phonetic: "/pÊŠt É’n/", type: "Phrasal Verb", definition: "Máº·c vÃ o, báº­t lÃªn", example: "Put on your coat before going outside." },
      { word: "recycle", phonetic: "/ËŒriËËˆsaÉªkÉ™l/", type: "Verb", definition: "TÃ¡i cháº¿", example: "We should recycle paper and plastic." },
      { word: "recycling", phonetic: "/ËŒriËËˆsaÉªklÉªÅ‹/", type: "Noun", definition: "Sá»± tÃ¡i cháº¿", example: "Recycling helps reduce waste." },
      { word: "recyclable", phonetic: "/ËŒriËËˆsaÉªklÉ™bÉ™l/", type: "Adjective", definition: "CÃ³ thá»ƒ tÃ¡i cháº¿", example: "This bottle is recyclable." },
      { word: "result", phonetic: "/rÉªËˆzÊŒlt/", type: "Noun/Verb", definition: "Káº¿t quáº£", example: "Global warming is the result of human activities." },
      { word: "result in", phonetic: "/rÉªËˆzÊŒlt Éªn/", type: "Phrasal Verb", definition: "Dáº«n Ä‘áº¿n", example: "Pollution can result in serious health problems." },
      { word: "grassland", phonetic: "/ËˆÉ¡rÉ‘ËslÃ¦nd/", type: "Noun", definition: "Äá»“ng cá»", example: "Grasslands are home to many animals." },
      { word: "desert", phonetic: "/ËˆdezÉ™t/", type: "Noun", definition: "Sa máº¡c", example: "Deserts are expanding due to climate change." },
      { word: "swamp", phonetic: "/swÉ’mp/", type: "Noun", definition: "Äáº§m láº§y", example: "Swamps are important wetland ecosystems." },
      { word: "temperature", phonetic: "/ËˆtemprÉ™tÊƒÉ™(r)/", type: "Noun", definition: "Nhiá»‡t Ä‘á»™", example: "Global temperatures are rising every year." },
      { word: "hurricane", phonetic: "/ËˆhÊŒrÉªkÉ™n/", type: "Noun", definition: "BÃ£o nhiá»‡t Ä‘á»›i", example: "Hurricanes are becoming more powerful." },
      { word: "get rid of", phonetic: "/É¡et rÉªd É™v/", type: "Phrasal Verb", definition: "Loáº¡i bá»", example: "We need to get rid of single-use plastics." },
      { word: "cloth bag", phonetic: "/klÉ’Î¸ bÃ¦É¡/", type: "Noun", definition: "TÃºi váº£i", example: "Use a cloth bag instead of plastic bags." },
      { word: "energy-efficient", phonetic: "/ËˆenÉ™dÊ’i ÉªËˆfÉªÊƒÉ™nt/", type: "Adjective", definition: "Tiáº¿t kiá»‡m nÄƒng lÆ°á»£ng", example: "Energy-efficient appliances help reduce electricity use." }
    ];

    // Reading quiz questions
    const readingQuestions = [
      {
        question: "Question 1: The word <u>'pressing'</u> in paragraph 1 is CLOSEST in meaning to ________________.",
        options: ["A. simple", "B. urgent", "C. minor", "D. optional"],
        correct: 1
      },
      {
        question: "Question 2: What does the word <u>'These'</u> in paragraph 1 refer to?",
        options: ["A. human activities", "B. greenhouse gas emissions", "C. carbon dioxide and methane", "D. scientists"],
        correct: 1
      },
      {
        question: "Question 3: The word <u>'alarming'</u> in paragraph 2 is OPPOSITE in meaning to ________________.",
        options: ["A. frightening", "B. worrying", "C. reassuring", "D. shocking"],
        correct: 2
      },
      {
        question: "Question 4: In which paragraph does the writer mention solutions to global warming?",
        options: ["A. Paragraph 1", "B. Paragraph 2", "C. Paragraph 3", "D. Paragraph 4"],
        correct: 3
      },
      {
        question: "Question 5: Where in paragraph 3 does the following sentence best fit? <br><em>'This destruction not only releases stored carbon but also eliminates crucial habitats for countless species.'</em>",
        options: ["A. [I]", "B. [II]", "C. [III]", "D. [IV]"],
        correct: 1
      },
      {
        question: "Question 6: Which of the following is TRUE according to the passage?",
        options: ["A. Global warming has no visible consequences yet.", "B. The Amazon rainforest is called the 'lungs of the Earth'.", "C. Fossil fuels are no longer used for energy production.", "D. Individual actions cannot help reduce carbon footprint."],
        correct: 1
      },
      {
        question: "Question 7: Which of the following best summarizes the main message of the passage?",
        options: ["A. Global warming is caused only by deforestation and cannot be stopped.", "B. Climate change is a serious problem, but collective action can still reduce its worst effects.", "C. Renewable energy alone can completely solve all environmental problems.", "D. It is too late to do anything about global warming and we should accept it."],
        correct: 1
      },
      {
        question: "Question 8: Which of the following can be inferred from the passage?",
        options: ["A. Scientists believe it is too late to reverse the effects of global warming.", "B. Deforestation has no significant impact on atmospheric carbon dioxide levels.", "C. Renewable energy sources alone can solve all environmental problems instantly.", "D. Collective action from governments, businesses, and individuals is necessary to address climate change."],
        correct: 3
      }
    ];

    // Vocabulary test questions (62 questions - one for each vocabulary item)
    const vocabTestQuestions = [
      { question: "What does 'reuse' (v) mean?", options: ["A) TÃ¡i sá»­ dá»¥ng", "B) Vá»©t bá»", "C) Mua má»›i", "D) PhÃ¡ há»§y"], correct: 0, word: "reuse (v)" },
      { question: "What does 'reuse' (n) mean?", options: ["A) Sá»± phÃ¡ há»§y", "B) Sá»± tÃ¡i sá»­ dá»¥ng", "C) Sá»± lÃ£ng phÃ­", "D) Sá»± mua sáº¯m"], correct: 1, word: "reuse (n)" },
      { question: "What does 'reusable' mean?", options: ["A) KhÃ´ng thá»ƒ dÃ¹ng láº¡i", "B) DÃ¹ng má»™t láº§n", "C) CÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng", "D) Äáº¯t tiá»n"], correct: 2, word: "reusable" },
      { question: "What does 'surgeon' mean?", options: ["A) BÃ¡c sÄ© pháº«u thuáº­t", "B) Y tÃ¡", "C) DÆ°á»£c sÄ©", "D) Nha sÄ©"], correct: 0, word: "surgeon" },
      { question: "What does 'wildfire' mean?", options: ["A) Lá»­a tráº¡i", "B) ÄÃ¨n lá»“ng", "C) ChÃ¡y rá»«ng", "D) PhÃ¡o hoa"], correct: 2, word: "wildfire" },
      { question: "What does 'arctic' mean?", options: ["A) Nam cá»±c", "B) Nhiá»‡t Ä‘á»›i", "C) Ã”n Ä‘á»›i", "D) Báº¯c cá»±c"], correct: 3, word: "arctic" },
      { question: "What does 'care' mean?", options: ["A) Sá»± chÄƒm sÃ³c", "B) Sá»± ghÃ©t bá»", "C) Sá»± phÃ¡ hoáº¡i", "D) Sá»± lÃ£ng quÃªn"], correct: 0, word: "care" },
      { question: "What does 'careful' mean?", options: ["A) Báº¥t cáº©n", "B) Cáº©n tháº­n", "C) Vá»™i vÃ ng", "D) LÆ°á»i biáº¿ng"], correct: 1, word: "careful" },
      { question: "What does 'careless' mean?", options: ["A) Cáº©n tháº­n", "B) Chu Ä‘Ã¡o", "C) Báº¥t cáº©n", "D) Tá»‰ má»‰"], correct: 2, word: "careless" },
      { question: "What does 'caring' mean?", options: ["A) Ãch ká»·", "B) Láº¡nh lÃ¹ng", "C) Chu Ä‘Ã¡o, quan tÃ¢m", "D) Thá» Æ¡"], correct: 2, word: "caring" },
      { question: "What does 'computer programmer' mean?", options: ["A) Thá»£ sá»­a mÃ¡y tÃ­nh", "B) Láº­p trÃ¬nh viÃªn mÃ¡y tÃ­nh", "C) NgÆ°á»i bÃ¡n mÃ¡y tÃ­nh", "D) GiÃ¡o viÃªn tin há»c"], correct: 1, word: "computer programmer" },
      { question: "What does 'determined' mean?", options: ["A) Do dá»±", "B) Quyáº¿t tÃ¢m", "C) LÆ°á»i biáº¿ng", "D) Sá»£ hÃ£i"], correct: 1, word: "determined" },
      { question: "What does 'determinedly' mean?", options: ["A) Má»™t cÃ¡ch do dá»±", "B) Má»™t cÃ¡ch quyáº¿t tÃ¢m", "C) Má»™t cÃ¡ch lÆ°á»i biáº¿ng", "D) Má»™t cÃ¡ch sá»£ hÃ£i"], correct: 1, word: "determinedly" },
      { question: "What does 'determine' mean?", options: ["A) XÃ¡c Ä‘á»‹nh, quyáº¿t Ä‘á»‹nh", "B) Tá»« bá»", "C) Nghi ngá»", "D) LÃ£ng quÃªn"], correct: 0, word: "determine" },
      { question: "What does 'determination' mean?", options: ["A) Sá»± yáº¿u Ä‘uá»‘i", "B) Sá»± quyáº¿t tÃ¢m", "C) Sá»± do dá»±", "D) Sá»± sá»£ hÃ£i"], correct: 1, word: "determination" },
      { question: "What does 'drought' mean?", options: ["A) LÅ© lá»¥t", "B) BÃ£o", "C) Háº¡n hÃ¡n", "D) Äá»™ng Ä‘áº¥t"], correct: 2, word: "drought" },
      { question: "What does 'ecosystem' mean?", options: ["A) Há»‡ sinh thÃ¡i", "B) Há»‡ thá»‘ng mÃ¡y tÃ­nh", "C) Há»‡ thá»‘ng giÃ¡o dá»¥c", "D) Há»‡ thá»‘ng giao thÃ´ng"], correct: 0, word: "ecosystem" },
      { question: "What does 'effect' (n) mean?", options: ["A) NguyÃªn nhÃ¢n", "B) áº¢nh hÆ°á»Ÿng, tÃ¡c Ä‘á»™ng", "C) Káº¿t quáº£ tá»‘t", "D) Sá»± tháº¥t báº¡i"], correct: 1, word: "effect" },
      { question: "What does 'affect' (v) mean?", options: ["A) Bá» qua", "B) áº¢nh hÆ°á»Ÿng Ä‘áº¿n", "C) TrÃ¡nh xa", "D) QuÃªn Ä‘i"], correct: 1, word: "affect" },
      { question: "What does 'affected' mean?", options: ["A) KhÃ´ng bá»‹ áº£nh hÆ°á»Ÿng", "B) Bá»‹ áº£nh hÆ°á»Ÿng", "C) ÄÆ°á»£c báº£o vá»‡", "D) ÄÆ°á»£c cáº£i thiá»‡n"], correct: 1, word: "affected" },
      { question: "What does 'emission' mean?", options: ["A) KhÃ­ tháº£i", "B) KhÃ´ng khÃ­ sáº¡ch", "C) NÆ°á»›c sáº¡ch", "D) Äáº¥t sáº¡ch"], correct: 0, word: "emission" },
      { question: "What does 'emit' mean?", options: ["A) Háº¥p thá»¥", "B) Tháº£i ra, phÃ¡t ra", "C) Lá»c sáº¡ch", "D) Giá»¯ láº¡i"], correct: 1, word: "emit" },
      { question: "What does 'extinct' mean?", options: ["A) Äang phÃ¡t triá»ƒn", "B) Tuyá»‡t chá»§ng", "C) Äang sinh sáº£n", "D) Äang di cÆ°"], correct: 1, word: "extinct" },
      { question: "What does 'extinction' mean?", options: ["A) Sá»± sinh sÃ´i", "B) Sá»± tuyá»‡t chá»§ng", "C) Sá»± phÃ¡t triá»ƒn", "D) Sá»± báº£o tá»“n"], correct: 1, word: "extinction" },
      { question: "What does 'extreme weather' mean?", options: ["A) Thá»i tiáº¿t Ä‘áº¹p", "B) Thá»i tiáº¿t bÃ¬nh thÆ°á»ng", "C) Thá»i tiáº¿t cá»±c Ä‘oan", "D) Thá»i tiáº¿t áº¥m Ã¡p"], correct: 2, word: "extreme weather" },
      { question: "What does 'flight attendant' mean?", options: ["A) Phi cÃ´ng", "B) Tiáº¿p viÃªn hÃ ng khÃ´ng", "C) Ká»¹ sÆ° hÃ ng khÃ´ng", "D) NhÃ¢n viÃªn sÃ¢n bay"], correct: 1, word: "flight attendant" },
      { question: "What does 'flood' mean?", options: ["A) Háº¡n hÃ¡n", "B) LÅ© lá»¥t", "C) BÃ£o", "D) Äá»™ng Ä‘áº¥t"], correct: 1, word: "flood" },
      { question: "What does 'fumes' mean?", options: ["A) KhÃ´ng khÃ­ sáº¡ch", "B) NÆ°á»›c sáº¡ch", "C) KhÃ³i Ä‘á»™c", "D) Ãnh sÃ¡ng"], correct: 2, word: "fumes" },
      { question: "What does 'heat up' mean?", options: ["A) LÃ m láº¡nh", "B) NÃ³ng lÃªn", "C) ÄÃ³ng bÄƒng", "D) á»”n Ä‘á»‹nh"], correct: 1, word: "heat up" },
      { question: "What does 'heatwave' mean?", options: ["A) Äá»£t láº¡nh", "B) Äá»£t nÃ³ng", "C) MÆ°a lá»›n", "D) GiÃ³ máº¡nh"], correct: 1, word: "heatwave" },
      { question: "What does 'ice cap' mean?", options: ["A) MÅ© bÄƒng", "B) Chá»m bÄƒng", "C) Táº£ng bÄƒng trÃ´i", "D) NÆ°á»›c Ä‘Ã¡"], correct: 1, word: "ice cap" },
      { question: "What does 'inventive' mean?", options: ["A) NhÃ m chÃ¡n", "B) SÃ¡ng táº¡o", "C) Lá»—i thá»i", "D) ÄÆ¡n giáº£n"], correct: 1, word: "inventive" },
      { question: "What does 'inventively' mean?", options: ["A) Má»™t cÃ¡ch nhÃ m chÃ¡n", "B) Má»™t cÃ¡ch sÃ¡ng táº¡o", "C) Má»™t cÃ¡ch lá»—i thá»i", "D) Má»™t cÃ¡ch Ä‘Æ¡n giáº£n"], correct: 1, word: "inventively" },
      { question: "What does 'inventiveness' mean?", options: ["A) TÃ­nh nhÃ m chÃ¡n", "B) TÃ­nh sÃ¡ng táº¡o", "C) TÃ­nh lá»—i thá»i", "D) TÃ­nh Ä‘Æ¡n giáº£n"], correct: 1, word: "inventiveness" },
      { question: "What does 'invent' mean?", options: ["A) PhÃ¡ há»§y", "B) PhÃ¡t minh", "C) Sao chÃ©p", "D) Mua bÃ¡n"], correct: 1, word: "invent" },
      { question: "What does 'invention' mean?", options: ["A) Sá»± phÃ¡ há»§y", "B) PhÃ¡t minh", "C) Sá»± sao chÃ©p", "D) Sá»± mua bÃ¡n"], correct: 1, word: "invention" },
      { question: "What does 'inventor' mean?", options: ["A) NgÆ°á»i phÃ¡ hoáº¡i", "B) NhÃ  phÃ¡t minh", "C) NgÆ°á»i sao chÃ©p", "D) NgÆ°á»i mua bÃ¡n"], correct: 1, word: "inventor" },
      { question: "What does 'landslide' mean?", options: ["A) LÅ© lá»¥t", "B) Sáº¡t lá»Ÿ Ä‘áº¥t", "C) Äá»™ng Ä‘áº¥t", "D) BÃ£o"], correct: 1, word: "landslide" },
      { question: "What does 'loss' mean?", options: ["A) Sá»± thu Ä‘Æ°á»£c", "B) Sá»± máº¥t mÃ¡t", "C) Sá»± tÄƒng thÃªm", "D) Sá»± phÃ¡t triá»ƒn"], correct: 1, word: "loss" },
      { question: "What does 'lose' mean?", options: ["A) TÃ¬m tháº¥y", "B) Máº¥t, Ä‘Ã¡nh máº¥t", "C) Giá»¯ láº¡i", "D) TÄƒng thÃªm"], correct: 1, word: "lose" },
      { question: "What does 'marine' mean?", options: ["A) Thuá»™c vá» nÃºi", "B) Thuá»™c vá» sa máº¡c", "C) Thuá»™c vá» biá»ƒn", "D) Thuá»™c vá» rá»«ng"], correct: 2, word: "marine" },
      { question: "What does 'organic' mean?", options: ["A) HÃ³a há»c", "B) CÃ´ng nghiá»‡p", "C) Há»¯u cÆ¡", "D) NhÃ¢n táº¡o"], correct: 2, word: "organic" },
      { question: "What does 'organically' mean?", options: ["A) Má»™t cÃ¡ch hÃ³a há»c", "B) Má»™t cÃ¡ch cÃ´ng nghiá»‡p", "C) Má»™t cÃ¡ch há»¯u cÆ¡", "D) Má»™t cÃ¡ch nhÃ¢n táº¡o"], correct: 2, word: "organically" },
      { question: "What does 'plumber' mean?", options: ["A) Thá»£ Ä‘iá»‡n", "B) Thá»£ sá»­a á»‘ng nÆ°á»›c", "C) Thá»£ má»™c", "D) Thá»£ sÆ¡n"], correct: 1, word: "plumber" },
      { question: "What does 'politician' mean?", options: ["A) GiÃ¡o viÃªn", "B) BÃ¡c sÄ©", "C) ChÃ­nh trá»‹ gia", "D) Ká»¹ sÆ°"], correct: 2, word: "politician" },
      { question: "What does 'politics' mean?", options: ["A) Kinh táº¿", "B) ChÃ­nh trá»‹", "C) VÄƒn hÃ³a", "D) Thá»ƒ thao"], correct: 1, word: "politics" },
      { question: "What does 'political' mean?", options: ["A) Thuá»™c vá» kinh táº¿", "B) Thuá»™c vá» chÃ­nh trá»‹", "C) Thuá»™c vá» vÄƒn hÃ³a", "D) Thuá»™c vá» thá»ƒ thao"], correct: 1, word: "political" },
      { question: "What does 'put off' mean?", options: ["A) Báº¯t Ä‘áº§u ngay", "B) HoÃ£n láº¡i", "C) HoÃ n thÃ nh", "D) Tiáº¿p tá»¥c"], correct: 1, word: "put off" },
      { question: "What does 'put on' mean?", options: ["A) Cá»Ÿi ra", "B) Máº·c vÃ o, báº­t lÃªn", "C) Táº¯t Ä‘i", "D) Vá»©t bá»"], correct: 1, word: "put on" },
      { question: "What does 'recycle' mean?", options: ["A) Vá»©t bá»", "B) TÃ¡i cháº¿", "C) Äá»‘t chÃ¡y", "D) ChÃ´n láº¥p"], correct: 1, word: "recycle" },
      { question: "What does 'recycling' mean?", options: ["A) Sá»± vá»©t bá»", "B) Sá»± tÃ¡i cháº¿", "C) Sá»± Ä‘á»‘t chÃ¡y", "D) Sá»± chÃ´n láº¥p"], correct: 1, word: "recycling" },
      { question: "What does 'recyclable' mean?", options: ["A) KhÃ´ng thá»ƒ tÃ¡i cháº¿", "B) CÃ³ thá»ƒ tÃ¡i cháº¿", "C) Äá»™c háº¡i", "D) Nguy hiá»ƒm"], correct: 1, word: "recyclable" },
      { question: "What does 'result' mean?", options: ["A) NguyÃªn nhÃ¢n", "B) Káº¿t quáº£", "C) QuÃ¡ trÃ¬nh", "D) Báº¯t Ä‘áº§u"], correct: 1, word: "result" },
      { question: "What does 'result in' mean?", options: ["A) NgÄƒn cháº·n", "B) Dáº«n Ä‘áº¿n", "C) TrÃ¡nh xa", "D) Bá» qua"], correct: 1, word: "result in" },
      { question: "What does 'grassland' mean?", options: ["A) Rá»«ng", "B) Äá»“ng cá»", "C) Sa máº¡c", "D) NÃºi"], correct: 1, word: "grassland" },
      { question: "What does 'desert' mean?", options: ["A) Rá»«ng", "B) Äá»“ng cá»", "C) Sa máº¡c", "D) Biá»ƒn"], correct: 2, word: "desert" },
      { question: "What does 'swamp' mean?", options: ["A) NÃºi cao", "B) Äáº§m láº§y", "C) Sa máº¡c", "D) Äá»“ng báº±ng"], correct: 1, word: "swamp" },
      { question: "What does 'temperature' mean?", options: ["A) Äá»™ áº©m", "B) Nhiá»‡t Ä‘á»™", "C) Ãp suáº¥t", "D) Tá»‘c Ä‘á»™ giÃ³"], correct: 1, word: "temperature" },
      { question: "What does 'hurricane' mean?", options: ["A) MÆ°a nhá»", "B) GiÃ³ nháº¹", "C) BÃ£o nhiá»‡t Ä‘á»›i", "D) SÆ°Æ¡ng mÃ¹"], correct: 2, word: "hurricane" },
      { question: "What does 'get rid of' mean?", options: ["A) Giá»¯ láº¡i", "B) Loáº¡i bá»", "C) Thu tháº­p", "D) Báº£o quáº£n"], correct: 1, word: "get rid of" },
      { question: "What does 'cloth bag' mean?", options: ["A) TÃºi nhá»±a", "B) TÃºi váº£i", "C) TÃºi giáº¥y", "D) TÃºi da"], correct: 1, word: "cloth bag" },
      { question: "What does 'energy-efficient' mean?", options: ["A) LÃ£ng phÃ­ nÄƒng lÆ°á»£ng", "B) Tiáº¿t kiá»‡m nÄƒng lÆ°á»£ng", "C) KhÃ´ng dÃ¹ng nÄƒng lÆ°á»£ng", "D) Tá»‘n nhiá»u nÄƒng lÆ°á»£ng"], correct: 1, word: "energy-efficient" }
    ];

    // Grammar quiz questions (30 questions)
    const grammarQuestions = [
      { question: "1. Scientists ___ new evidence of climate change recently.", options: ["A) discovered", "B) have discovered", "C) had discovered", "D) discover"], correct: 1 },
      { question: "2. The ice ___ before scientists arrived to study it.", options: ["A) melted", "B) has melted", "C) had melted", "D) melts"], correct: 2 },
      { question: "3. If we reduce emissions, the planet ___ recover.", options: ["A) will", "B) would", "C) will have", "D) would have"], correct: 0 },
      { question: "4. If we ___ more forests, air quality would improve.", options: ["A) have", "B) had", "C) have had", "D) will have"], correct: 1 },
      { question: "5. If we ___ earlier, we would have prevented this.", options: ["A) act", "B) acted", "C) had acted", "D) have acted"], correct: 2 },
      { question: "6. ___ I the president, I would ban fossil fuels.", options: ["A) Was", "B) Were", "C) Am", "D) Had been"], correct: 1 },
      { question: "7. ___ we known, we would have acted differently.", options: ["A) If", "B) Should", "C) Had", "D) Were"], correct: 2 },
      { question: "8. No sooner ___ the rain stopped than the sun appeared.", options: ["A) has", "B) have", "C) had", "D) did"], correct: 2 },
      { question: "9. Hardly ___ we arrived when the storm began.", options: ["A) have", "B) has", "C) had", "D) did"], correct: 2 },
      { question: "10. They ___ in renewable energy for five years.", options: ["A) invest", "B) invested", "C) have invested", "D) had invested"], correct: 2 },
      { question: "11. By 2020, temperatures ___ by 1.5 degrees.", options: ["A) rose", "B) have risen", "C) had risen", "D) rise"], correct: 2 },
      { question: "12. If it ___ tomorrow, we will cancel the trip.", options: ["A) rains", "B) rained", "C) will rain", "D) would rain"], correct: 0 },
      { question: "13. If I ___ you, I would recycle more.", options: ["A) am", "B) was", "C) were", "D) had been"], correct: 2 },
      { question: "14. She ___ never ___ such pollution before.", options: ["A) has/seen", "B) have/seen", "C) had/seen", "D) did/see"], correct: 0 },
      { question: "15. ___ should you need help, call me immediately.", options: ["A) If", "B) Should", "C) Had", "D) Were"], correct: 1 },
      { question: "16. The forest ___ before the fire started.", options: ["A) has been dry", "B) was dry", "C) had been dry", "D) is dry"], correct: 2 },
      { question: "17. Scarcely ___ the meeting started when the alarm rang.", options: ["A) has", "B) have", "C) had", "D) did"], correct: 2 },
      { question: "18. If we ___ solar panels, we would save money.", options: ["A) install", "B) installed", "C) have installed", "D) had installed"], correct: 1 },
      { question: "19. They ___ the project last month.", options: ["A) complete", "B) completed", "C) have completed", "D) had completed"], correct: 1 },
      { question: "20. ___ the government acted sooner, the situation would be better.", options: ["A) If", "B) Should", "C) Had", "D) Were"], correct: 2 },
      { question: "21. We ___ this problem for years.", options: ["A) discuss", "B) discussed", "C) have discussed", "D) had discussed"], correct: 2 },
      { question: "22. If you ___ the lights off, you will save energy.", options: ["A) turn", "B) turned", "C) will turn", "D) would turn"], correct: 0 },
      { question: "23. No sooner ___ he finished speaking than everyone applauded.", options: ["A) has", "B) have", "C) had", "D) did"], correct: 2 },
      { question: "24. The animals ___ their habitat before humans arrived.", options: ["A) lost", "B) have lost", "C) had lost", "D) lose"], correct: 2 },
      { question: "25. If she ___ harder, she would pass the exam.", options: ["A) studies", "B) studied", "C) will study", "D) would study"], correct: 1 },
      { question: "26. ___ I known about this, I would have helped.", options: ["A) If", "B) Should", "C) Had", "D) Were"], correct: 2 },
      { question: "27. Hardly ___ the ice melted when the sea level rose.", options: ["A) has", "B) have", "C) had", "D) did"], correct: 2 },
      { question: "28. Scientists ___ this species since 2010.", options: ["A) study", "B) studied", "C) have studied", "D) had studied"], correct: 2 },
      { question: "29. If it ___ not for renewable energy, we would be in trouble.", options: ["A) is", "B) was", "C) were", "D) had been"], correct: 2 },
      { question: "30. The temperature ___ significantly by the end of last year.", options: ["A) rose", "B) has risen", "C) had risen", "D) rises"], correct: 2 }
    ];

    // State
    let currentCard = 0;
    let userProgress = null;
    let readingAnswers = new Array(readingQuestions.length).fill(null);
    let grammarAnswers = new Array(grammarQuestions.length).fill(null);
    let vocabTestAnswers = new Array(vocabTestQuestions.length).fill(null);
    let vocabTestScore = 0;
    let currentVocabTestQuestion = 0;

    // Audio context for sound effects
    const correctSound = () => {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = 800;
      oscillator.type = 'sine';
      
      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + 0.5);
    };

    const incorrectSound = () => {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = 200;
      oscillator.type = 'sawtooth';
      
      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + 0.5);
    };

    // Data SDK Handler
    const dataHandler = {
      onDataChanged(data) {
        if (data.length > 0) {
          userProgress = data[0];
        }
        // LuÃ´n cáº­p nháº­t hiá»ƒn thá»‹ sau khi nháº­n dá»¯ liá»‡u
        updateProgressDisplay();
      }
    };

    async function initDataSDK() {
      const result = await window.dataSdk.init(dataHandler);
      if (!result.isOk) {
        console.error("Failed to initialize Data SDK");
      }
    }

    async function saveProgress() {
      const vocabProgress = Math.round(((currentCard + 1) / vocabularyCards.length) * 100);
      const readingProg = userProgress?.reading_progress || 0;
      const grammarProg = userProgress?.grammar_progress || 0;
      const totalProgress = Math.round((vocabProgress + readingProg + grammarProg) / 3);
      
      const progressData = {
        id: "user_progress",
        vocabulary_progress: vocabProgress,
        reading_progress: readingProg,
        grammar_progress: grammarProg,
        total_progress: totalProgress,
        vocabulary_completed: currentCard + 1,
        reading_score: userProgress?.reading_score || 0,
        grammar_score: userProgress?.grammar_score || 0,
        last_updated: new Date().toISOString()
      };

      if (userProgress && userProgress.__backendId) {
        const result = await window.dataSdk.update({ ...progressData, __backendId: userProgress.__backendId });
        if (result.isOk) {
          // Cáº­p nháº­t userProgress ngay láº­p tá»©c Ä‘á»ƒ UI pháº£n Ã¡nh ngay
          userProgress = { ...progressData, __backendId: userProgress.__backendId };
        }
      } else {
        const result = await window.dataSdk.create(progressData);
        // Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c cáº­p nháº­t qua onDataChanged
      }
    }

    function updateProgressDisplay() {
      const totalProg = userProgress?.total_progress || 0;
      const vocabProg = userProgress?.vocabulary_progress || 0;
      const readingProg = userProgress?.reading_progress || 0;
      const grammarProg = userProgress?.grammar_progress || 0;

      const totalEl = document.getElementById('total-progress');
      const vocabEl = document.getElementById('vocab-progress');
      const readingEl = document.getElementById('reading-progress');
      const grammarEl = document.getElementById('grammar-progress');

      if (totalEl) totalEl.textContent = `${totalProg}%`;
      if (vocabEl) vocabEl.textContent = `${vocabProg}%`;
      if (readingEl) readingEl.textContent = `${readingProg}%`;
      if (grammarEl) grammarEl.textContent = `${grammarProg}%`;
    }

    // Text-to-speech function
    function speakWord(word) {
      // Extract the base word without part of speech
      const baseWord = word.split('(')[0].trim();
      
      if ('speechSynthesis' in window) {
        // Cancel any ongoing speech
        window.speechSynthesis.cancel();
        
        // Small delay to ensure cancellation completes (important for mobile)
        setTimeout(() => {
          const utterance = new SpeechSynthesisUtterance(baseWord);
          utterance.lang = 'en-US';
          utterance.rate = 0.8;
          utterance.pitch = 1;
          utterance.volume = 1;
          
          // Load voices if not already loaded (critical for mobile browsers)
          if (window.speechSynthesis.getVoices().length === 0) {
            window.speechSynthesis.addEventListener('voiceschanged', () => {
              const voices = window.speechSynthesis.getVoices();
              const englishVoice = voices.find(v => v.lang.startsWith('en'));
              if (englishVoice) {
                utterance.voice = englishVoice;
              }
              window.speechSynthesis.speak(utterance);
            }, { once: true });
          } else {
            const voices = window.speechSynthesis.getVoices();
            const englishVoice = voices.find(v => v.lang.startsWith('en'));
            if (englishVoice) {
              utterance.voice = englishVoice;
            }
            window.speechSynthesis.speak(utterance);
          }
        }, 100);
      }
    }

    // Flashcard functionality
    function updateFlashcard() {
      const card = vocabularyCards[currentCard];
      const flashcardContainer = document.getElementById('flashcard-container');
      
      flashcardContainer.classList.remove('flipped');
      
      setTimeout(() => {
        document.querySelector('.flashcard-front h2').textContent = card.word;
        document.querySelector('.flashcard-front h4').textContent = card.phonetic;
        document.querySelector('.flashcard-front p:nth-of-type(1)').textContent = card.type;
        document.querySelector('.flashcard-back h3').textContent = card.word;
        document.querySelector('.flashcard-back h4').textContent = card.phonetic;
        document.querySelector('.flashcard-back p:nth-of-type(1)').innerHTML = `<strong>${card.type}:</strong> ${card.definition}`;
        document.querySelector('.flashcard-back p:nth-of-type(2)').innerHTML = `<em>Example:</em> ${card.example}`;
        
        // Auto-play pronunciation
        speakWord(card.word);
      }, 300);

      document.getElementById('card-counter').textContent = `${currentCard + 1} / ${vocabularyCards.length}`;
      document.getElementById('vocab-progress-bar').style.width = `${((currentCard + 1) / vocabularyCards.length) * 100}%`;

      // Cáº­p nháº­t hiá»ƒn thá»‹ tiáº¿n Ä‘á»™ ngay láº­p tá»©c
      const vocabProgress = Math.round(((currentCard + 1) / vocabularyCards.length) * 100);
      const vocabEl = document.getElementById('vocab-progress');
      if (vocabEl) vocabEl.textContent = `${vocabProgress}%`;
      
      // Cáº­p nháº­t tá»•ng tiáº¿n Ä‘á»™
      const readingProg = userProgress?.reading_progress || 0;
      const grammarProg = userProgress?.grammar_progress || 0;
      const totalProgress = Math.round((vocabProgress + readingProg + grammarProg) / 3);
      const totalEl = document.getElementById('total-progress');
      if (totalEl) totalEl.textContent = `${totalProgress}%`;

      saveProgress();
    }

    document.getElementById('flashcard-container').addEventListener('click', function() {
      this.classList.toggle('flipped');
    });

    document.getElementById('prev-btn').addEventListener('click', function() {
      if (currentCard > 0) {
        currentCard--;
        updateFlashcard();
      }
    });

    document.getElementById('next-btn').addEventListener('click', function() {
      if (currentCard < vocabularyCards.length - 1) {
        currentCard++;
        updateFlashcard();
      }
    });

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
      const activeSection = document.querySelector('#vocab-section:not(.hidden)');
      if (!activeSection) return;

      if (e.code === 'Space') {
        e.preventDefault();
        document.getElementById('flashcard-container').classList.toggle('flipped');
      } else if (e.code === 'ArrowLeft') {
        document.getElementById('prev-btn').click();
      } else if (e.code === 'ArrowRight') {
        document.getElementById('next-btn').click();
      }
    });

    // Tab navigation
    function switchTab(tabName) {
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
        btn.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
        btn.style.color = config.text_color || defaultConfig.text_color;
      });
      
      document.getElementById('vocab-section').classList.add('hidden');
      document.getElementById('reading-section').classList.add('hidden');
      document.getElementById('grammar-section').classList.add('hidden');
      document.getElementById('ecosystem-section').classList.add('hidden');

      if (tabName === 'vocab') {
        const vocabTab = document.getElementById('vocab-tab');
        vocabTab.classList.add('active');
        vocabTab.style.backgroundColor = config.primary_action_color || defaultConfig.primary_action_color;
        vocabTab.style.color = '#ffffff';
        document.getElementById('vocab-section').classList.remove('hidden');
      } else if (tabName === 'reading') {
        const readingTab = document.getElementById('reading-tab');
        readingTab.classList.add('active');
        readingTab.style.backgroundColor = config.primary_action_color || defaultConfig.primary_action_color;
        readingTab.style.color = '#ffffff';
        document.getElementById('reading-section').classList.remove('hidden');
      } else if (tabName === 'grammar') {
        const grammarTab = document.getElementById('grammar-tab');
        grammarTab.classList.add('active');
        grammarTab.style.backgroundColor = config.primary_action_color || defaultConfig.primary_action_color;
        grammarTab.style.color = '#ffffff';
        document.getElementById('grammar-section').classList.remove('hidden');
      } else if (tabName === 'ecosystem') {
        const ecosystemTab = document.getElementById('ecosystem-tab');
        ecosystemTab.classList.add('active');
        ecosystemTab.style.backgroundColor = config.primary_action_color || defaultConfig.primary_action_color;
        ecosystemTab.style.color = '#ffffff';
        document.getElementById('ecosystem-section').classList.remove('hidden');
      }
    }

    document.getElementById('vocab-tab').addEventListener('click', () => switchTab('vocab'));
    document.getElementById('reading-tab').addEventListener('click', () => switchTab('reading'));
    document.getElementById('grammar-tab').addEventListener('click', () => switchTab('grammar'));
    document.getElementById('ecosystem-tab').addEventListener('click', () => switchTab('ecosystem'));

    // Mode switching for vocabulary section
    document.getElementById('flashcard-mode-btn').addEventListener('click', function() {
      document.getElementById('flashcard-mode').classList.remove('hidden');
      document.getElementById('test-mode').classList.add('hidden');
      this.style.opacity = '1';
      document.getElementById('test-mode-btn').style.opacity = '0.7';
    });

    document.getElementById('test-mode-btn').addEventListener('click', function() {
      document.getElementById('flashcard-mode').classList.add('hidden');
      document.getElementById('test-mode').classList.remove('hidden');
      this.style.opacity = '1';
      document.getElementById('flashcard-mode-btn').style.opacity = '0.7';
      if (document.getElementById('vocab-test-container').children.length === 0) {
        initVocabTest();
      }
    });

    // Initialize vocabulary test
    function initVocabTest() {
      currentVocabTestQuestion = 0;
      vocabTestScore = 0;
      vocabTestAnswers = new Array(vocabTestQuestions.length).fill(null);
      displayVocabTestQuestion();
    }

    function displayVocabTestQuestion() {
      const container = document.getElementById('vocab-test-container');
      const q = vocabTestQuestions[currentVocabTestQuestion];
      const isAnswered = vocabTestAnswers[currentVocabTestQuestion] !== null;
      
      container.innerHTML = `
        <div class="fade-in p-4 md:p-6 rounded-lg shadow-md mb-4" style="background-color: ${config.surface_color || defaultConfig.surface_color}">
          <p class="font-semibold mb-4 text-base md:text-lg" style="color: ${config.text_color || defaultConfig.text_color}">${currentVocabTestQuestion + 1}. ${q.question}</p>
          <div class="space-y-3">
            ${q.options.map((opt, i) => `
              <button class="vocab-test-option w-full text-left p-3 md:p-4 rounded-lg border-2 text-sm md:text-base transition-all ${isAnswered ? 'cursor-not-allowed' : ''}" 
                      data-answer="${i}" 
                      ${isAnswered ? 'disabled' : ''}
                      style="border-color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; color: ${config.text_color || defaultConfig.text_color}">
                ${opt}
              </button>
            `).join('')}
          </div>
          <div id="vocab-test-feedback" class="mt-4 p-4 rounded-lg hidden"></div>
        </div>
      `;

      // Update counter and progress bar
      document.getElementById('test-counter').textContent = `CÃ¢u ${currentVocabTestQuestion + 1} / ${vocabTestQuestions.length}`;
      document.getElementById('test-progress-bar').style.width = `${((currentVocabTestQuestion + 1) / vocabTestQuestions.length) * 100}%`;

      // Update navigation buttons
      const prevBtn = document.getElementById('prev-vocab-test-btn');
      const nextBtn = document.getElementById('next-vocab-test-btn');
      
      prevBtn.disabled = currentVocabTestQuestion === 0;
      prevBtn.style.opacity = currentVocabTestQuestion === 0 ? '0.5' : '1';
      
      if (currentVocabTestQuestion === vocabTestQuestions.length - 1 && isAnswered) {
        nextBtn.textContent = 'Xem káº¿t quáº£';
      } else {
        nextBtn.textContent = 'CÃ¢u tiáº¿p â†’';
      }

      // If already answered, show the result
      if (isAnswered) {
        showVocabTestAnswer(vocabTestAnswers[currentVocabTestQuestion], true);
      } else {
        // Add click handlers for options
        document.querySelectorAll('.vocab-test-option').forEach(btn => {
          btn.addEventListener('click', function() {
            const answerIndex = parseInt(this.dataset.answer);
            vocabTestAnswers[currentVocabTestQuestion] = answerIndex;
            showVocabTestAnswer(answerIndex, false);
          });
        });
      }
    }

    function showVocabTestAnswer(userAnswer, skipSound = false) {
      const q = vocabTestQuestions[currentVocabTestQuestion];
      const correctAnswer = q.correct;
      const buttons = document.querySelectorAll('.vocab-test-option');
      const feedbackDiv = document.getElementById('vocab-test-feedback');
      
      // Disable all buttons
      buttons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add('cursor-not-allowed');
      });
      
      // Highlight correct answer
      buttons[correctAnswer].classList.add('correct');
      
      // Show feedback
      if (userAnswer === correctAnswer) {
        if (!skipSound) {
          vocabTestScore++;
          correctSound();
        }
        feedbackDiv.style.backgroundColor = '#d1fae5';
        feedbackDiv.style.color = '#065f46';
        feedbackDiv.innerHTML = `<strong>âœ“ ChÃ­nh xÃ¡c!</strong> Tá»«: <em>${q.word}</em>`;
      } else {
        if (!skipSound) incorrectSound();
        buttons[userAnswer].classList.add('incorrect');
        feedbackDiv.style.backgroundColor = '#fee2e2';
        feedbackDiv.style.color = '#991b1b';
        feedbackDiv.innerHTML = `<strong>âœ— Sai rá»“i!</strong> ÄÃ¡p Ã¡n Ä‘Ãºng: <strong>${q.options[correctAnswer]}</strong><br>Tá»«: <em>${q.word}</em>`;
      }
      
      feedbackDiv.classList.remove('hidden');
    }

    async function showVocabTestResult() {
      // Calculate final score
      let finalScore = 0;
      vocabTestAnswers.forEach((answer, index) => {
        if (answer === vocabTestQuestions[index].correct) {
          finalScore++;
        }
      });

      const percentage = Math.round((finalScore / vocabTestQuestions.length) * 100);
      const resultDiv = document.getElementById('test-result');
      const resultText = resultDiv.querySelector('p:first-child');
      const resultDetail = resultDiv.querySelector('p:last-child');
      
      resultText.textContent = `Äiá»ƒm cá»§a báº¡n: ${finalScore}/${vocabTestQuestions.length}`;
      resultDetail.textContent = `Tá»· lá»‡ Ä‘Ãºng: ${percentage}%`;
      
      if (percentage >= 90) {
        resultDiv.style.backgroundColor = '#d1fae5';
        resultDiv.style.color = '#065f46';
        resultDetail.textContent += ' - Xuáº¥t sáº¯c! ğŸ‰';
      } else if (percentage >= 70) {
        resultDiv.style.backgroundColor = '#dbeafe';
        resultDiv.style.color = '#1e40af';
        resultDetail.textContent += ' - KhÃ¡ tá»‘t! ğŸ‘';
      } else if (percentage >= 50) {
        resultDiv.style.backgroundColor = '#fef3c7';
        resultDiv.style.color = '#92400e';
        resultDetail.textContent += ' - Cáº§n cá»‘ gáº¯ng thÃªm! ğŸ’ª';
      } else {
        resultDiv.style.backgroundColor = '#fee2e2';
        resultDiv.style.color = '#991b1b';
        resultDetail.textContent += ' - HÃ£y Ã´n láº¡i tá»« vá»±ng nhÃ©! ğŸ“š';
      }
      
      resultDiv.classList.remove('hidden');

      // Save vocabulary test progress
      const readingProg = userProgress?.reading_progress || 0;
      const grammarProg = userProgress?.grammar_progress || 0;
      const totalProg = Math.round((percentage + readingProg + grammarProg) / 3);

      if (userProgress && userProgress.__backendId) {
        const progressData = {
          id: userProgress.id,
          vocabulary_progress: percentage,
          reading_progress: readingProg,
          grammar_progress: grammarProg,
          total_progress: totalProg,
          vocabulary_completed: vocabTestQuestions.length,
          reading_score: userProgress.reading_score || 0,
          grammar_score: userProgress.grammar_score || 0,
          last_updated: new Date().toISOString(),
          __backendId: userProgress.__backendId
        };
        const result = await window.dataSdk.update(progressData);
        if (result.isOk) {
          // Cáº­p nháº­t userProgress ngay láº­p tá»©c
          userProgress = progressData;
          updateProgressDisplay();
        }
      } else {
        const progressData = {
          id: "user_progress",
          vocabulary_progress: percentage,
          reading_progress: 0,
          grammar_progress: 0,
          total_progress: Math.round(percentage / 3),
          vocabulary_completed: vocabTestQuestions.length,
          reading_score: 0,
          grammar_score: 0,
          last_updated: new Date().toISOString()
        };
        const result = await window.dataSdk.create(progressData);
        if (result.isOk) {
          // Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c cáº­p nháº­t qua onDataChanged
          updateProgressDisplay();
        }
      }
      
      // Scroll to result
      resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // Navigation buttons for vocabulary test
    document.getElementById('prev-vocab-test-btn').addEventListener('click', function() {
      if (currentVocabTestQuestion > 0) {
        currentVocabTestQuestion--;
        displayVocabTestQuestion();
      }
    });

    document.getElementById('next-vocab-test-btn').addEventListener('click', async function() {
      // Check if current question is answered
      if (vocabTestAnswers[currentVocabTestQuestion] === null) {
        const feedbackDiv = document.getElementById('vocab-test-feedback');
        feedbackDiv.style.backgroundColor = '#fef3c7';
        feedbackDiv.style.color = '#92400e';
        feedbackDiv.innerHTML = '<strong>âš ï¸ Vui lÃ²ng chá»n má»™t Ä‘Ã¡p Ã¡n trÆ°á»›c khi tiáº¿p tá»¥c!</strong>';
        feedbackDiv.classList.remove('hidden');
        return;
      }

      // If last question and answered, show final result
      if (currentVocabTestQuestion === vocabTestQuestions.length - 1) {
        await showVocabTestResult();
      } else {
        currentVocabTestQuestion++;
        displayVocabTestQuestion();
      }
    });

    // Initialize reading quiz
    function initReadingQuiz() {
      const container = document.getElementById('reading-quiz');
      container.innerHTML = '';

      readingQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'fade-in';
        questionDiv.innerHTML = `
          <p class="font-semibold mb-3 text-sm md:text-base">${q.question}</p>
          <div class="space-y-2">
            ${q.options.map((opt, i) => `
              <button class="quiz-option w-full text-left p-3 md:p-4 rounded-lg border-2 text-sm md:text-base" data-question="${index}" data-answer="${i}">
                ${opt}
              </button>
            `).join('')}
          </div>
        `;
        container.appendChild(questionDiv);
      });

      document.querySelectorAll('.quiz-option').forEach(btn => {
        btn.addEventListener('click', function() {
          const questionIndex = parseInt(this.dataset.question);
          const answerIndex = parseInt(this.dataset.answer);
          
          document.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(b => {
            b.classList.remove('correct', 'incorrect');
            b.style.borderColor = config.secondary_action_color || defaultConfig.secondary_action_color;
          });
          
          readingAnswers[questionIndex] = answerIndex;
          this.style.borderColor = config.primary_action_color || defaultConfig.primary_action_color;
        });
      });
    }

    document.getElementById('submit-reading').addEventListener('click', async function() {
      let score = 0;
      const buttons = document.querySelectorAll('.quiz-option');
      
      readingQuestions.forEach((q, index) => {
        const userAnswer = readingAnswers[index];
        const correctAnswer = q.correct;
        
        const questionButtons = document.querySelectorAll(`[data-question="${index}"]`);
        questionButtons[correctAnswer].classList.add('correct');
        
        if (userAnswer !== null) {
          if (userAnswer === correctAnswer) {
            score++;
            correctSound();
          } else {
            questionButtons[userAnswer].classList.add('incorrect');
            incorrectSound();
          }
        }
      });

      const percentage = Math.round((score / readingQuestions.length) * 100);
      const resultDiv = document.getElementById('reading-result');
      resultDiv.querySelector('p').textContent = `Äiá»ƒm cá»§a báº¡n: ${score}/${readingQuestions.length} (${percentage}%)`;
      resultDiv.style.backgroundColor = percentage >= 70 ? '#86efac' : '#fca5a5';
      resultDiv.classList.remove('hidden');

      // Save reading progress
      const vocabProg = userProgress?.vocabulary_progress || 0;
      const grammarProg = userProgress?.grammar_progress || 0;
      const totalProg = Math.round((vocabProg + percentage + grammarProg) / 3);

      if (userProgress && userProgress.__backendId) {
        const progressData = {
          id: userProgress.id,
          vocabulary_progress: vocabProg,
          reading_progress: percentage,
          grammar_progress: grammarProg,
          total_progress: totalProg,
          vocabulary_completed: userProgress.vocabulary_completed || 0,
          reading_score: score,
          grammar_score: userProgress.grammar_score || 0,
          last_updated: new Date().toISOString(),
          __backendId: userProgress.__backendId
        };
        const result = await window.dataSdk.update(progressData);
        if (result.isOk) {
          // Cáº­p nháº­t userProgress ngay láº­p tá»©c
          userProgress = progressData;
          updateProgressDisplay();
        }
      } else {
        const progressData = {
          id: "user_progress",
          vocabulary_progress: 0,
          reading_progress: percentage,
          grammar_progress: 0,
          total_progress: Math.round(percentage / 3),
          vocabulary_completed: 0,
          reading_score: score,
          grammar_score: 0,
          last_updated: new Date().toISOString()
        };
        const result = await window.dataSdk.create(progressData);
        if (result.isOk) {
          // Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c cáº­p nháº­t qua onDataChanged
          updateProgressDisplay();
        }
      }

      this.disabled = true;
      this.style.opacity = '0.5';
    });

    // Grammar toggles
    document.querySelectorAll('.grammar-toggle').forEach(button => {
      button.addEventListener('click', function() {
        const targetId = this.dataset.target;
        const content = document.getElementById(targetId);
        const icon = this.querySelector('span:last-child');
        
        content.classList.toggle('active');
        icon.textContent = content.classList.contains('active') ? 'âˆ’' : '+';
      });
    });

    // Grammar quiz state
    let currentGrammarQuestion = 0;
    let grammarScore = 0;

    // Initialize grammar quiz
    function initGrammarQuiz() {
      currentGrammarQuestion = 0;
      grammarScore = 0;
      grammarAnswers = new Array(grammarQuestions.length).fill(null);
      displayGrammarQuestion();
    }

    function displayGrammarQuestion() {
      const container = document.getElementById('grammar-quiz-container');
      const q = grammarQuestions[currentGrammarQuestion];
      const isAnswered = grammarAnswers[currentGrammarQuestion] !== null;
      
      container.innerHTML = `
        <div class="fade-in p-4 md:p-6 rounded-lg shadow-md" style="background-color: ${config.surface_color || defaultConfig.surface_color}">
          <p class="font-semibold mb-4 text-base md:text-lg" style="color: ${config.text_color || defaultConfig.text_color}">${q.question}</p>
          <div class="space-y-3">
            ${q.options.map((opt, i) => `
              <button class="grammar-option w-full text-left p-3 md:p-4 rounded-lg border-2 text-sm md:text-base transition-all ${isAnswered ? 'cursor-not-allowed' : ''}" 
                      data-answer="${i}" 
                      ${isAnswered ? 'disabled' : ''}
                      style="border-color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; color: ${config.text_color || defaultConfig.text_color}">
                ${opt}
              </button>
            `).join('')}
          </div>
          <div id="grammar-feedback" class="mt-4 p-4 rounded-lg hidden"></div>
        </div>
      `;

      // Update counter and progress bar
      document.getElementById('grammar-counter').textContent = `CÃ¢u ${currentGrammarQuestion + 1} / ${grammarQuestions.length}`;
      document.getElementById('grammar-progress-bar').style.width = `${((currentGrammarQuestion + 1) / grammarQuestions.length) * 100}%`;

      // Update navigation buttons
      const prevBtn = document.getElementById('prev-grammar-btn');
      const nextBtn = document.getElementById('next-grammar-btn');
      
      prevBtn.disabled = currentGrammarQuestion === 0;
      prevBtn.style.opacity = currentGrammarQuestion === 0 ? '0.5' : '1';
      
      if (currentGrammarQuestion === grammarQuestions.length - 1 && isAnswered) {
        nextBtn.textContent = 'Xem káº¿t quáº£';
      } else {
        nextBtn.textContent = 'CÃ¢u tiáº¿p â†’';
      }

      // If already answered, show the result
      if (isAnswered) {
        showGrammarAnswer(grammarAnswers[currentGrammarQuestion], true);
      } else {
        // Add click handlers for options
        document.querySelectorAll('.grammar-option').forEach(btn => {
          btn.addEventListener('click', function() {
            const answerIndex = parseInt(this.dataset.answer);
            grammarAnswers[currentGrammarQuestion] = answerIndex;
            showGrammarAnswer(answerIndex, false);
          });
        });
      }
    }

    function showGrammarAnswer(userAnswer, skipSound = false) {
      const q = grammarQuestions[currentGrammarQuestion];
      const correctAnswer = q.correct;
      const buttons = document.querySelectorAll('.grammar-option');
      const feedbackDiv = document.getElementById('grammar-feedback');
      
      // Disable all buttons
      buttons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add('cursor-not-allowed');
      });
      
      // Highlight correct answer
      buttons[correctAnswer].classList.add('correct');
      
      // Show feedback
      if (userAnswer === correctAnswer) {
        if (!skipSound) {
          grammarScore++;
          correctSound();
        }
        feedbackDiv.style.backgroundColor = '#d1fae5';
        feedbackDiv.style.color = '#065f46';
        feedbackDiv.innerHTML = '<strong>âœ“ ChÃ­nh xÃ¡c!</strong> Báº¡n Ä‘Ã£ chá»n Ä‘Ãºng Ä‘Ã¡p Ã¡n.';
      } else {
        if (!skipSound) incorrectSound();
        buttons[userAnswer].classList.add('incorrect');
        feedbackDiv.style.backgroundColor = '#fee2e2';
        feedbackDiv.style.color = '#991b1b';
        feedbackDiv.innerHTML = `<strong>âœ— Sai rá»“i!</strong> ÄÃ¡p Ã¡n Ä‘Ãºng lÃ : <strong>${q.options[correctAnswer]}</strong>`;
      }
      
      feedbackDiv.classList.remove('hidden');
    }

    // Navigation buttons
    document.getElementById('prev-grammar-btn').addEventListener('click', function() {
      if (currentGrammarQuestion > 0) {
        currentGrammarQuestion--;
        displayGrammarQuestion();
      }
    });

    document.getElementById('next-grammar-btn').addEventListener('click', async function() {
      // Check if current question is answered
      if (grammarAnswers[currentGrammarQuestion] === null) {
        const feedbackDiv = document.getElementById('grammar-feedback');
        feedbackDiv.style.backgroundColor = '#fef3c7';
        feedbackDiv.style.color = '#92400e';
        feedbackDiv.innerHTML = '<strong>âš ï¸ Vui lÃ²ng chá»n má»™t Ä‘Ã¡p Ã¡n trÆ°á»›c khi tiáº¿p tá»¥c!</strong>';
        feedbackDiv.classList.remove('hidden');
        return;
      }

      // If last question and answered, show final result
      if (currentGrammarQuestion === grammarQuestions.length - 1) {
        await showGrammarFinalResult();
      } else {
        currentGrammarQuestion++;
        displayGrammarQuestion();
      }
    });

    async function showGrammarFinalResult() {
      // Calculate score
      let finalScore = 0;
      grammarAnswers.forEach((answer, index) => {
        if (answer === grammarQuestions[index].correct) {
          finalScore++;
        }
      });

      const percentage = Math.round((finalScore / grammarQuestions.length) * 100);
      const resultDiv = document.getElementById('grammar-result');
      const resultText = resultDiv.querySelector('p:first-child');
      const resultDetail = resultDiv.querySelector('p:last-child');
      
      resultText.textContent = `Äiá»ƒm cá»§a báº¡n: ${finalScore}/${grammarQuestions.length}`;
      resultDetail.textContent = `Tá»· lá»‡ Ä‘Ãºng: ${percentage}%`;
      
      if (percentage >= 90) {
        resultDiv.style.backgroundColor = '#d1fae5';
        resultDiv.style.color = '#065f46';
        resultDetail.textContent += ' - Xuáº¥t sáº¯c! ğŸ‰';
      } else if (percentage >= 70) {
        resultDiv.style.backgroundColor = '#dbeafe';
        resultDiv.style.color = '#1e40af';
        resultDetail.textContent += ' - KhÃ¡ tá»‘t! ğŸ‘';
      } else if (percentage >= 50) {
        resultDiv.style.backgroundColor = '#fef3c7';
        resultDiv.style.color = '#92400e';
        resultDetail.textContent += ' - Cáº§n cá»‘ gáº¯ng thÃªm! ğŸ’ª';
      } else {
        resultDiv.style.backgroundColor = '#fee2e2';
        resultDiv.style.color = '#991b1b';
        resultDetail.textContent += ' - HÃ£y Ã´n láº¡i ngá»¯ phÃ¡p nhÃ©! ğŸ“š';
      }
      
      resultDiv.classList.remove('hidden');

      // Save grammar progress
      const vocabProg = userProgress?.vocabulary_progress || 0;
      const readingProg = userProgress?.reading_progress || 0;
      const totalProg = Math.round((vocabProg + readingProg + percentage) / 3);

      if (userProgress && userProgress.__backendId) {
        const progressData = {
          id: userProgress.id,
          vocabulary_progress: vocabProg,
          reading_progress: readingProg,
          grammar_progress: percentage,
          total_progress: totalProg,
          vocabulary_completed: userProgress.vocabulary_completed || 0,
          reading_score: userProgress.reading_score || 0,
          grammar_score: finalScore,
          last_updated: new Date().toISOString(),
          __backendId: userProgress.__backendId
        };
        const result = await window.dataSdk.update(progressData);
        if (result.isOk) {
          // Cáº­p nháº­t userProgress ngay láº­p tá»©c
          userProgress = progressData;
          updateProgressDisplay();
        }
      } else {
        const progressData = {
          id: "user_progress",
          vocabulary_progress: 0,
          reading_progress: 0,
          grammar_progress: percentage,
          total_progress: Math.round(percentage / 3),
          vocabulary_completed: 0,
          reading_score: 0,
          grammar_score: finalScore,
          last_updated: new Date().toISOString()
        };
        const result = await window.dataSdk.create(progressData);
        if (result.isOk) {
          // Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c cáº­p nháº­t qua onDataChanged
          updateProgressDisplay();
        }
      }

      // Scroll to result
      resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // Element SDK
    async function onConfigChange(newConfig) {
      const baseFont = newConfig.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = newConfig.font_size || defaultConfig.font_size;

      document.body.style.backgroundColor = newConfig.background_color || defaultConfig.background_color;
      document.body.style.color = newConfig.text_color || defaultConfig.text_color;
      document.body.style.fontFamily = `${baseFont}, ${baseFontStack}`;
      document.body.style.fontSize = `${baseSize}px`;

      document.getElementById('unit-title').textContent = newConfig.unit_title || defaultConfig.unit_title;
      document.getElementById('unit-title').style.fontSize = `${baseSize * 2}px`;
      document.getElementById('unit-title').style.color = newConfig.text_color || defaultConfig.text_color;

      document.getElementById('progress-title').textContent = newConfig.progress_title || defaultConfig.progress_title;
      document.getElementById('progress-title').style.fontSize = `${baseSize * 1.25}px`;

      document.getElementById('vocabulary-tab-text').textContent = newConfig.vocabulary_tab || defaultConfig.vocabulary_tab;
      document.getElementById('reading-tab-text').textContent = newConfig.reading_tab || defaultConfig.reading_tab;
      document.getElementById('grammar-tab-text').textContent = newConfig.grammar_tab || defaultConfig.grammar_tab;
      document.getElementById('ecosystem-tab-text').textContent = newConfig.ecosystem_tab || defaultConfig.ecosystem_tab;
      document.getElementById('home-button-text').textContent = newConfig.home_button || defaultConfig.home_button;
      document.getElementById('submit-button-text').textContent = newConfig.submit_button || defaultConfig.submit_button;

      document.querySelectorAll('.progress-card').forEach(card => {
        card.style.backgroundColor = newConfig.surface_color || defaultConfig.surface_color;
        card.style.color = newConfig.text_color || defaultConfig.text_color;
      });

      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.style.backgroundColor = newConfig.secondary_action_color || defaultConfig.secondary_action_color;
        btn.style.color = newConfig.text_color || defaultConfig.text_color;
      });

      document.querySelectorAll('.tab-button.active').forEach(btn => {
        btn.style.backgroundColor = newConfig.primary_action_color || defaultConfig.primary_action_color;
        btn.style.color = '#ffffff';
      });

      document.querySelectorAll('.flashcard-front, .flashcard-back').forEach(el => {
        el.style.background = `linear-gradient(135deg, ${newConfig.primary_action_color || defaultConfig.primary_action_color} 0%, #0284c7 100%)`;
      });

      document.querySelectorAll('.control-button').forEach(btn => {
        btn.style.backgroundColor = newConfig.primary_action_color || defaultConfig.primary_action_color;
        btn.style.color = '#ffffff';
      });

      const vocabProgressBar = document.getElementById('vocab-progress-bar');
      if (vocabProgressBar) {
        vocabProgressBar.style.backgroundColor = newConfig.primary_action_color || defaultConfig.primary_action_color;
      }
      
      const testProgressBar = document.getElementById('test-progress-bar');
      if (testProgressBar) {
        testProgressBar.style.backgroundColor = newConfig.primary_action_color || defaultConfig.primary_action_color;
      }
      
      const grammarProgressBar = document.getElementById('grammar-progress-bar');
      if (grammarProgressBar) {
        grammarProgressBar.style.backgroundColor = newConfig.primary_action_color || defaultConfig.primary_action_color;
      }
      
      document.getElementById('home-btn').style.backgroundColor = newConfig.primary_action_color || defaultConfig.primary_action_color;

      document.querySelectorAll('.rounded-lg.p-6, .rounded-lg.p-8, .rounded-lg.p-4').forEach(el => {
        if (!el.classList.contains('progress-card')) {
          el.style.backgroundColor = newConfig.surface_color || defaultConfig.surface_color;
          el.style.color = newConfig.text_color || defaultConfig.text_color;
        }
      });
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (cfg) => ({
          recolorables: [
            {
              get: () => cfg.background_color || defaultConfig.background_color,
              set: (value) => {
                cfg.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => cfg.surface_color || defaultConfig.surface_color,
              set: (value) => {
                cfg.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => cfg.text_color || defaultConfig.text_color,
              set: (value) => {
                cfg.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => cfg.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => {
                cfg.primary_action_color = value;
                window.elementSdk.setConfig({ primary_action_color: value });
              }
            },
            {
              get: () => cfg.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => {
                cfg.secondary_action_color = value;
                window.elementSdk.setConfig({ secondary_action_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => cfg.font_family || defaultConfig.font_family,
            set: (value) => {
              cfg.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => cfg.font_size || defaultConfig.font_size,
            set: (value) => {
              cfg.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (cfg) => new Map([
          ["unit_title", cfg.unit_title || defaultConfig.unit_title],
          ["progress_title", cfg.progress_title || defaultConfig.progress_title],
          ["vocabulary_tab", cfg.vocabulary_tab || defaultConfig.vocabulary_tab],
          ["reading_tab", cfg.reading_tab || defaultConfig.reading_tab],
          ["grammar_tab", cfg.grammar_tab || defaultConfig.grammar_tab],
          ["ecosystem_tab", cfg.ecosystem_tab || defaultConfig.ecosystem_tab],
          ["home_button", cfg.home_button || defaultConfig.home_button],
          ["submit_button", cfg.submit_button || defaultConfig.submit_button]
        ])
      });

      config = window.elementSdk.config;
    }

    // Initialize
    initDataSDK();
    updateFlashcard();
    initReadingQuiz();
    initGrammarQuiz();
    onConfigChange(config);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99b5a31c9509fdcc',t:'MTc2MjYxMDg1MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>